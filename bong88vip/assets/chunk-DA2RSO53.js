import{a as _,b as N,c as y,d as c,e as Gt,f,g as v,h as C,i as u,j as Et}from"./chunk-F55EZFGA.js";import{Aa as Ot,E as Dt,H as X,J as F,L as st,Q as Z,T as ot,e as kt,g as E,i as V,ja as Mt,la as at,oa as j,s as Rt,sa as rt,x as nt,xa as ht,ya as Ft,z as q,za as Nt}from"./chunk-LOMIDAH7.js";import{a as U,b as Bt,g as B}from"./chunk-MON7YFGF.js";var h={calHistory:{i:1e3,percent:{top:10,left:2106}},table:{i:1},dealer:{i:1e3,n:"dealer"},plate:{i:200,a:2e3},bettingSpot:{i:100,n:"spotsContainer",spot:{n:a=>"spot"+a.toString()},spot1:{actionIndex:1},spot2:{actionIndex:2},spot3:{actionIndex:3},spot4:{actionIndex:7},spot5:{actionIndex:4},spot6:{actionIndex:5},spot7:{actionIndex:6},spotArea:{n:a=>"spotArea"+a.toString()}},tableHistory:{i:110},player:{i:1e3,n:"playerContainer",other:{n:"otherPlayer"},o:{avatar:{container:{n:"avatarContainer"},n:"avatar"},balance:{background:{n:"balanceBackground"}}}},denomination:{i:120,n:"denominationsContainer",mask:{n:"denominationsMaskWrapper",wrapper:{n:"denominationsWrapper"}},item:{n:a=>"denomination"+a.toString(),active:{n:"denominationActive"},icon:{n:"icon"}}},listCoinBet:{i:900},coinTossWinAnimation:{i:1e3,n:"winAnimationContainer"}};var dt=class{destroy(){this.plate01?.destroy(),this.plate02?.destroy(),this.plateContainer?.destroy(),this.plate01=null,this.plate02=null,this.plateContainer=null}constructor(t){this.container=t,this.plateContainer=new y,this.plate01Width=172,this.plate01Height=165,this.plate01Ratio=this.plate01Width/this.plate01Height,this.plate02Width=186,this.plate02Height=180,this.plate02Ratio=this.plate02Width/this.plate02Height,this.assets=u.getInstance(),this.containerHeight=649,this.containerWidth=553,this.coinContainer=new y,this.coinContainerWidth=260,this.coinContainerHeight=260,this.shakeAmplitude=10,this.shakeFrequency=.8,this.shakeTime=0,this.plateContainer.sortableChildren=!0,this.plateContainer.width=this.containerWidth,this.plateContainer.height=this.containerHeight,this.plate01=new c(this.assets.gameAssets.coinToss.plate01),this.plate02=new c(this.assets.gameAssets.coinToss.plate02),this.plate01.zIndex=20,this.plateContainer.zIndex=h.plate.i,this.plate02.zIndex=1,this.plate02.width=417,this.plate02.height=this.plate02.width/this.plate02Ratio,this.plate02.x=23,this.plate02.y=this.containerHeight-this.plate02.height-23,this.plate01.width=370,this.plate01.height=this.plate01.width/this.plate01Ratio,this.plate01.x=this.plate02.x+26,this.plate01.y=this.plate02.y+20,this.plateContainer.addChild(this.plate02),this.plateContainer.addChild(this.plate01),this.plateContainer.x=1540,this.plateContainer.y=443,this.container.addChild(this.plateContainer)}addCoin(t,s){this.coinContainer.sortableChildren=!0,this.coinContainer.zIndex=10,this.coinContainer.width=this.coinContainerWidth,this.coinContainer.height=this.coinContainerHeight,this.coinContainer.x=100,this.coinContainer.y=290;let i=[];for(let e=0;e<t;e++){let n=new c(this.assets.gameAssets.coinToss.coin01);n.width=87,n.height=87;let o;do o=this.getRandomPosition(n.width,n.height,this.coinContainerWidth,this.coinContainerHeight);while(this.isOverlap(o,i));i.push(o),n.x=o.x,n.y=o.y,this.coinContainer.addChild(n)}for(let e=0;e<s;e++){let n=new c(this.assets.gameAssets.coinToss.coin02);n.width=87,n.height=87;let o;do o=this.getRandomPosition(n.width,n.height,this.coinContainerWidth,this.coinContainerHeight);while(this.isOverlap(o,i));i.push(o),n.x=o.x,n.y=o.y,this.coinContainer.addChild(n)}this.plateContainer?.addChild(this.coinContainer)}getRandomPosition(t,s,i,e){let n=Math.random()*(i-t),o=Math.random()*(e-s);return{x:n,y:o}}isOverlap(t,s){for(let i of s)if(Math.abs(i.x-t.x)<87&&Math.abs(i.y-t.y)<87)return!0;return!1}removeCoin(){this.coinContainer?.destroy(),this.coinContainer=null}shake(){return new Promise(t=>{this.assets.gameAssets.coinToss.soundPlateShake.play({loop:!0,singleInstance:!0});let s=this.plateContainer.position.x,i=this.plateContainer.position.y,e,n=()=>{this.plateContainer&&(this.shakeTime+=this.shakeFrequency,this.plateContainer.position.x=s+Math.sin(this.shakeTime)*this.shakeAmplitude,this.plateContainer.position.y=i+Math.cos(this.shakeTime)*this.shakeAmplitude,e=requestAnimationFrame(n))};n(),setTimeout(()=>{cancelAnimationFrame(e),this.assets.gameAssets.coinToss.soundPlateShake.stop(),t(!0)},1500)})}reset(){return new Promise(t=>{this.assets.gameAssets.coinToss.soundPlateReset.play({loop:!1,singleInstance:!0});let s=this.plate01.position.x,i=this.plate01.position.y,e=this.plate02.x+26,n=this.plate02.y+20,o=e-s,r=n-i,l=o/60,d=r/60,p=()=>{if(!this.plate01)return t(!0);this.plate01.position.x+=l,this.plate01.position.y+=d,l>0&&this.plate01.position.x<e||l<0&&this.plate01.position.x>e||d>0&&this.plate01.position.y<n||d<0&&this.plate01.position.y>n?requestAnimationFrame(p):(this.plate01.position.x=e,this.plate01.position.y=n,t(!0))};p()})}reveal(){return new Promise(t=>{this.assets.gameAssets.coinToss.soundPlateReveal.play({loop:!1,singleInstance:!0});let s=this.plate01.position.x,i=this.plate01.position.y,e=161-s,n=0-i,o=e/60,r=n/60,l=()=>{this.plate01&&(this.plate01.position.x+=o,this.plate01.position.y+=r,o>0&&this.plate01.position.x<161||o<0&&this.plate01.position.x>161||r>0&&this.plate01.position.y<0||r<0&&this.plate01.position.y>0?requestAnimationFrame(l):(this.plate01.position.x=161,this.plate01.position.y=0,t(!0)))};l()})}showPlate01(){return new Promise(t=>{let s=.03333333333333333,i=()=>{this.plate01&&(this.plate01.alpha+=s,this.plate01.alpha<1?requestAnimationFrame(i):(this.plate01.alpha=1,t(!0)))};i()})}hidePlate01(){return new Promise(t=>{let s=.03333333333333333,i=()=>{this.plate01&&(this.plate01.alpha-=s,this.plate01.alpha>0?requestAnimationFrame(i):(this.plate01.alpha=0,t(!0)))};i()})}};var Y={1:{top:{x:300,y:60},width:730,height:400},2:{top:{x:120,y:60},width:680,height:400},3:{top:{x:210,y:60},width:350,height:280},4:{top:{x:110,y:60},width:300,height:280},5:{top:{x:110,y:60},width:300,height:280},6:{top:{x:110,y:60},width:300,height:280},7:{top:{x:110,y:60},width:300,height:280}},lt=class{constructor(t,s){this.container=t,this.clickSpotAction=s,this.spotsContainer=new y,this.spotsContainerWidth=2735,this.spotsContainerHeight=925,this.assets=u.getInstance(),this.spot01Width=1093,this.spot01Height=497,this.spot03Width=606,this.spot03Height=391,this.spot05Width=455,this.textStyle=new v({fontFamily:this.assets.gameAssets.coinToss.notoSerif.family,fontSize:77,fill:"#f3e9e9",dropShadow:!0,dropShadowColor:"#f3e9e9",dropShadowBlur:10,dropShadowAlpha:.8,dropShadowDistance:0,dropShadowAngle:4}),this.coinSpotSize=46,this.coinSpotPadding=14,this.coinSpotX=151,this.spotEvenOddAnimation={},this.spotsContainer.sortableChildren=!0,this.spotsContainer.name=h.bettingSpot.n,this.spotsContainer.zIndex=h.bettingSpot.i,this.spotsContainer.x=405,this.spotsContainer.y=591,this.spot01=new c(this.assets.gameAssets.coinToss.bettingSpot0101),this.spot01.animationName="even",this.spot01.textureDefault=this.assets.gameAssets.coinToss.bettingSpot0101,this.spot01.winTexture=this.assets.gameAssets.coinToss.bettingSpot0102,this.spot01.spotWin=this.assets.gameAssets.coinToss.bettingSpot0103,this.spot01.zIndex=10,this.spot01.width=this.spot01Width,this.spot01.height=this.spot01Height,this.spot01.x=10,this.spot01.y=10,this.spot01.name=h.bettingSpot.spot.n(1),this.spot01.eventMode="static",this.spot01.cursor="pointer",this.spotsContainer?.addChild(this.spot01),this.spot01.on("pointerdown",()=>{s(h.bettingSpot.spot1.actionIndex)}),this.spot02=new c(this.assets.gameAssets.coinToss.bettingSpot0201),this.spot02.textureDefault=this.assets.gameAssets.coinToss.bettingSpot0201,this.spot02.animationName="odd",this.spot02.winTexture=this.assets.gameAssets.coinToss.bettingSpot0202,this.spot02.spotWin=this.assets.gameAssets.coinToss.bettingSpot0203,this.spot02.zIndex=10,this.spot02.width=this.spot01Width,this.spot02.height=this.spot01Height,this.spot02.x=1628,this.spot02.y=10,this.spot02.name=h.bettingSpot.spot.n(2),this.spot02.eventMode="static",this.spot02.cursor="pointer",this.spotsContainer?.addChild(this.spot02),this.spot02.on("pointerdown",()=>{s(h.bettingSpot.spot2.actionIndex)}),this.spot03=new c(this.assets.gameAssets.coinToss.bettingSpot0301),this.spot03.textureDefault=this.assets.gameAssets.coinToss.bettingSpot0301,this.spot03.animationName="fourRed",this.spot03.winTexture=this.assets.gameAssets.coinToss.bettingSpot0302,this.spot03.spotWin=this.assets.gameAssets.coinToss.bettingSpot0303,this.spot03.zIndex=10,this.spot03.width=this.spot03Width,this.spot03.height=this.spot03Height,this.spot03.x=5,this.spot03.y=524,this.spot03.name=h.bettingSpot.spot.n(3),this.spot03.eventMode="static",this.spot03.cursor="pointer",this.spotsContainer?.addChild(this.spot03),this.spot03.on("pointerdown",()=>{s(h.bettingSpot.spot3.actionIndex)}),this.spot04=new c(this.assets.gameAssets.coinToss.bettingSpot0401),this.spot04.textureDefault=this.assets.gameAssets.coinToss.bettingSpot0401,this.spot04.animationName="fourWhite",this.spot04.winTexture=this.assets.gameAssets.coinToss.bettingSpot0402,this.spot04.spotWin=this.assets.gameAssets.coinToss.bettingSpot0403,this.spot04.zIndex=10,this.spot04.width=this.spot03Width,this.spot04.height=this.spot03Height,this.spot04.x=2121,this.spot04.y=524,this.spot04.name=h.bettingSpot.spot.n(7),this.spot04.eventMode="static",this.spot04.cursor="pointer",this.spotsContainer?.addChild(this.spot04),this.spot04.on("pointerdown",()=>{s(h.bettingSpot.spot4.actionIndex)}),this.spot05=new c(this.assets.gameAssets.coinToss.bettingSpot0501),this.spot05.textureDefault=this.assets.gameAssets.coinToss.bettingSpot0501,this.spot05.animationName="threeRedOneWhite",this.spot05.winTexture=this.assets.gameAssets.coinToss.bettingSpot0502,this.spot05.spotWin=this.assets.gameAssets.coinToss.bettingSpot0503,this.spot05.zIndex=10,this.spot05.width=this.spot05Width,this.spot05.height=this.spot03Height,this.spot05.x=647,this.spot05.y=524,this.spot05.name=h.bettingSpot.spot.n(4),this.spot05.eventMode="static",this.spot05.cursor="pointer",this.spotsContainer?.addChild(this.spot05),this.spot05.on("pointerdown",()=>{s(h.bettingSpot.spot5.actionIndex)}),this.spot06=new c(this.assets.gameAssets.coinToss.bettingSpot0501),this.spot06.textureDefault=this.assets.gameAssets.coinToss.bettingSpot0501,this.spot06.animationName="twoRedTwoWhite",this.spot06.winTexture=this.assets.gameAssets.coinToss.bettingSpot0502,this.spot06.spotWin=this.assets.gameAssets.coinToss.bettingSpot0503,this.spot06.zIndex=10,this.spot06.width=this.spot05Width,this.spot06.height=this.spot03Height,this.spot06.x=1139,this.spot06.y=524,this.spot06.name=h.bettingSpot.spot.n(5),this.spot06.eventMode="static",this.spot06.cursor="pointer",this.spotsContainer?.addChild(this.spot06),this.spot06.on("pointerdown",()=>{s(h.bettingSpot.spot6.actionIndex)}),this.spot07=new c(this.assets.gameAssets.coinToss.bettingSpot0501),this.spot07.textureDefault=this.assets.gameAssets.coinToss.bettingSpot0501,this.spot07.animationName="oneRedThreeWhite",this.spot07.winTexture=this.assets.gameAssets.coinToss.bettingSpot0502,this.spot07.spotWin=this.assets.gameAssets.coinToss.bettingSpot0503,this.spot07.zIndex=10,this.spot07.width=this.spot05Width,this.spot07.height=this.spot03Height,this.spot07.x=1628,this.spot07.y=524,this.spot07.name=h.bettingSpot.spot.n(6),this.spot07.eventMode="static",this.spot07.cursor="pointer",this.spotsContainer?.addChild(this.spot07),this.spot07.on("pointerdown",()=>{s(h.bettingSpot.spot7.actionIndex)}),this.addCoinToSpot(4,0,0),this.addCoinToSpot(3,1,1),this.addCoinToSpot(2,2,2),this.addCoinToSpot(1,3,3),this.addCoinToSpot(0,4,4),this.addTextToTwoSpot("1:14.4",0),this.addTextToTwoSpot("1:3.75",1),this.addTextToTwoSpot("1:2.4",2),this.addTextToTwoSpot("1:3.75",3),this.addTextToTwoSpot("1:14.4",4),this.addTextToOneSpot("1:1.96",0),this.addTextToOneSpot("1:1.96",1);let i=new c(this.assets.gameAssets.coinToss.evenText);i.x=679-555,i.y=835-685,i.width=1055-679,i.height=i.width*(59/158),i.zIndex=20,this.spotsContainer?.addChild(i);let e=new c(this.assets.gameAssets.coinToss.oddText);e.x=2221-555,e.y=835-685,e.width=2365-2221,e.height=e.width*(65/60),e.zIndex=20,this.spotsContainer?.addChild(e),this.container.addChild(this.spotsContainer);for(let n=1;n<=7;n++)this.drawSpotArea(n)}drawSpotArea(t){let s=this.spotsContainer?.getChildByName(h.bettingSpot.spot.n(t));if(!s||!Y[t.toString()])return;let i=new f;i.zIndex=100,i.name=h.bettingSpot.spotArea.n(t),i.beginFill(9909289,1e-5),i.drawRect(0,0,Y[t.toString()].width,Y[t.toString()].height),i.x=s.x+Y[t.toString()].top.x,i.y=s.y+Y[t.toString()].top.y,this.spotsContainer?.addChild(i)}addTextToOneSpot(t,s){let i=new C(t,this.textStyle);i.anchor.set(1,0),i.x=s===0?1050:2587,i.y=211,i.zIndex=50,this.spotsContainer?.addChild(i)}addTextToTwoSpot(t,s){let i=new C(t,this.textStyle);i.anchor.set(1,0),i.x=s===4?2629:561+489*s,i.y=686,i.zIndex=50,this.spotsContainer?.addChild(i)}addCoinToSpot(t,s,i=0){let e=(n,o)=>{n.width=this.coinSpotSize,n.height=this.coinSpotSize,n.x=i===0?this.coinSpotX:i*491+this.coinSpotX+this.coinSpotSize,n.y=this.coinSpotPadding*o+this.coinSpotSize*o+602,n.zIndex=50,this.spotsContainer?.addChild(n)};for(let n=0;n<t;n++){let o=new c(this.assets.gameAssets.coinToss.coin02);e(o,n)}for(let n=0;n<s;n++){let o=new c(this.assets.gameAssets.coinToss.coin01);e(o,n+t)}}spotDefault(){this.spot01.texture=this.spot01.textureDefault,this.spot02.texture=this.spot02.textureDefault,this.spot03.texture=this.spot03.textureDefault,this.spot04.texture=this.spot04.textureDefault,this.spot05.texture=this.spot05.textureDefault,this.spot06.texture=this.spot06.textureDefault,this.spot07.texture=this.spot07.textureDefault}AddSpotWinAnimationV2(t,s=7e3){return new Promise(i=>{if(this.spotEvenOddAnimation[t.animationName])return i(!0);this.spotEvenOddAnimation[t.animationName]=!0;let e=new c(t.winTexture);e.width=t.width-20,e.height=t.height-20,e.x=t.x+10,e.y=t.y+10,e.zIndex=1,this.spotsContainer?.addChild(e),V(this.SpotWinAnimation(t,s)).subscribe(n=>{e.destroy(),this.spotsContainer?.removeChild(e),this.spotEvenOddAnimation[t.animationName]=!1,t.texture=t.spotWin,i(!0)})})}SpotWinAnimation(t,s=7e3){return new Promise(i=>{if(t.animation===!0)return i(!0);t.animation=!0;let e=new c(this.assets.gameAssets.coinToss.spotWinBg),n=Math.max(t.width,t.height)*1.5;e.anchor.x=.5,e.anchor.y=.5,e.position.x=t.width/2+t.x,e.position.y=t.height/2+t.y,e.width=n,e.height=n,e.mask=t,this.spotsContainer?.addChild(e);let o=2*Math.PI/120,r,l=()=>{e&&(e.rotation+=o,r=requestAnimationFrame(l))};l(),setTimeout(()=>{cancelAnimationFrame(r),e.mask=null,e.destroy(),this.spotsContainer?.removeChild(e),t.animation=!1,i(!0)},s)})}destroy(){this.spot01?.destroy(),this.spot01=null,this.spot02?.destroy(),this.spot02=null,this.spot03?.destroy(),this.spot03=null,this.spot04?.destroy(),this.spot04=null,this.spot05?.destroy(),this.spot05=null,this.spot06?.destroy(),this.spot06=null,this.spot07?.destroy(),this.spot07=null,this.spotsContainer?.removeChildren(),this.spotsContainer?.destroy(),this.spotsContainer=null,this.clickSpotAction=null}};var bt=u.getInstance(),P={10:{color:"#be7724",name:"10",index:0,value:10},20:{color:"#7f31c9",name:"20",index:1,value:20},50:{color:"#c63fad",name:"50",index:2,value:50},100:{color:"#146bce",name:"100",index:3,value:100},200:{color:"#0b9aac",name:"200",index:4,value:200},500:{color:"#bd2f18",name:"500",index:5,value:500},1e3:{color:"#0c1f34",name:"1k",index:6,value:1e3},2e3:{color:"#4b3e0d",name:"2k",index:7,value:2e3}},J=(a,t,s=0,i=0,e,n,o=340,r=!0,l,d,p)=>{let O=new v({fontFamily:bt.gameAssets.coinToss.notoSerifBold.family,fontSize:65,fill:["#d0cecf","#eeeded","#f5f5f6","#c6c6c6"],dropShadowAngle:4,stroke:"#3c3939",strokeThickness:10}),g=new y;g.sortableChildren=!0,g.zIndex=o,g.name=h.denomination.item.n(i);let x=new f;x.beginFill(parseInt(a.replace("#","0x"),16)),x.drawRoundedRect(0,0,e-14,n-14,Math.max(e-14,n-14)/2),x.position.set(7,14),x.endFill(),x.zIndex=1;let H=new c(bt.gameAssets.coinToss.denominations);if(H.zIndex=2,H.width=e-14,H.height=n-14,H.position.set(7,14),H.name=h.denomination.item.icon.n,l&&d){let T=new c(bt.gameAssets.coinToss.denominationsActive);T.name=h.denomination.item.active.n,T.zIndex=3,T.width=l,T.height=d,T.anchor.set(.5,.5),T.position.set(e/2,n/2+7),T.visible=!1,g.addChild(T)}if(r){let T=new C(t.toString().toUpperCase(),O);T.anchor.set(.5,.5),T.x=e/2,T.y=n/2+4,T.zIndex=5,g?.addChild(T)}return g.addChild(x),g.addChild(H),p&&(g.eventMode="dynamic",g.cursor="pointer",g.valueNumber=i,g.valueName=t,g.on("pointerdown",()=>{p(t)})),g.position.set((e+10)*s,0),g};var ct=class{constructor(t,s){this.container=t,this.betting=s,this.scaleAction=!0,this.denominationsContainer=new y,this.assets=u.getInstance(),this.denominationsSize={width:1780,height:231,padding:167},this.denominationsWrapper=new y,this.denominationsMaskWrapper=new y,this.backgroundGraphic=new f,this.rightArrow=new c(this.assets.gameAssets.coinToss.denominationRightArrow),this.leftArrow=new c(this.assets.gameAssets.coinToss.denominationLeftArrow),this.isDragging=!1,this.prevPointerPos=null,this.denominationSize={width:217,height:217,activeWidth:260,denominationRatio:239/223,activeScale:260/217,activeHeight:217*260/217},this.denominationContainers={},this.animationFrameId=null,this.denominationsContainer.zIndex=h.denomination.i,this.denominationsContainer.name=h.denomination.n,this.denominationsContainer.x=881,this.denominationsContainer.y=1541,this.backgroundGraphic.y=52,this.backgroundGraphic.beginFill(0,.5),this.backgroundGraphic.drawRoundedRect(0,0,this.denominationsSize.width,this.denominationsSize.height,115.5),this.backgroundGraphic.endFill(),this.backgroundGraphic.zIndex=310,this.denominationsMaskWrapper.sortableChildren=!0,this.denominationsMaskWrapper.name=h.denomination.mask.n,this.denominationsMaskWrapper.width=this.denominationsSize.width-this.denominationsSize.padding*2,this.denominationsMaskWrapper.height=this.denominationSize.activeHeight+30;let i=new f;i.beginFill(0,1),i.drawRect(0,0,this.denominationsSize.width-this.denominationsSize.padding*2,this.denominationSize.activeHeight+30),i.position.y=this.denominationsSize.height-this.denominationSize.activeHeight-30,this.denominationsMaskWrapper.mask=i,this.denominationsMaskWrapper?.addChild(i),this.denominationsMaskWrapper.position.set(this.denominationsSize.padding,52),this.denominationsMaskWrapper.zIndex=320,this.denominationsWrapper.sortableChildren=!0,this.denominationsWrapper.name=h.denomination.mask.wrapper.n,this.denominationsWrapper.width=this.denominationsSize.width-this.denominationsSize.padding*2,this.denominationsWrapper.height=this.denominationSize.activeHeight+30,this.denominationsWrapper.zIndex=320,this.denominationsContainer.addChild(this.backgroundGraphic),this.denominationsContainer.width=this.denominationsSize.width,this.denominationsContainer.height=this.denominationsSize.height,this.denominationsMaskWrapper.addChild(this.denominationsWrapper),this.denominationsContainer.addChild(this.denominationsMaskWrapper);for(let e in P)this.addDenomination(P[e].color,P[e].name,P[e].index,P[e].value);this.activeContainer("10",!1),this.leftArrow.width=98,this.leftArrow.height=98/(40/56),this.leftArrow.y=(this.denominationsContainer.height-this.leftArrow.height)/2+25,this.leftArrow.x=40,this.leftArrow.eventMode="dynamic",this.rightArrow.width=98,this.rightArrow.height=98/(40/56),this.rightArrow.y=(this.denominationsContainer.height-this.rightArrow.height)/2+25,this.rightArrow.x=this.denominationsContainer.width-130,this.rightArrow.eventMode="dynamic",this.rightArrow.on("pointerdown",()=>{this.moveRight()}),this.leftArrow.on("pointerdown",()=>{this.moveLeft()}),this.denominationsContainer.addChild(this.rightArrow),this.denominationsContainer.addChild(this.leftArrow),this.container.addChild(this.denominationsContainer),this.denominationsWrapper.eventMode="dynamic",this.denominationsWrapper.on("pointerdown",this.onDragStart.bind(this)),this.denominationsWrapper.on("pointerup",this.onDragEnd.bind(this)),this.denominationsWrapper.on("pointerupoutside",this.onDragEnd.bind(this)),this.denominationsWrapper.on("pointerleave",this.onDragEnd.bind(this)),this.denominationsWrapper.on("pointermove",this.onDragMove.bind(this))}onDragStart(t){this.isDragging=!0,this.prevPointerPos=t.data.getLocalPosition(this.denominationsWrapper)}onDragEnd(){this.isDragging=!1,this.prevPointerPos=null}onDragMove(t){if(!this.isDragging||!this.prevPointerPos)return;let s=t.data.getLocalPosition(this.denominationsWrapper),i=s.x-this.prevPointerPos.x,e=this.denominationsWrapper.x+i;e<10&&e>this.denominationsSize.width-this.denominationsSize.padding*2-40-this.denominationsWrapper.width&&(this.denominationsWrapper.x=e,this.prevPointerPos=s)}moveWrapperLeft(){let s=this.denominationContainers[Object.keys(this.denominationContainers)[0]].width*1.1,i=this.denominationsWrapper.x-s,e=1e3,n=performance.now(),o=r=>{if(!this.denominationsWrapper||!this.denominationsSize)return;let l=r-n,d=Math.min(l/e,1),p=this.denominationsWrapper.x-i*d;p<10&&p>this.denominationsSize.width-this.denominationsSize.padding*2-40-this.denominationsWrapper.width&&(this.denominationsWrapper.x=p),d<1&&requestAnimationFrame(o)};requestAnimationFrame(o)}moveWrapperRight(){let s=this.denominationContainers[Object.keys(this.denominationContainers)[0]].width*1.1,i=this.denominationsWrapper.x-s,e=1e3,n=performance.now(),o=r=>{if(!this.denominationsWrapper||!this.denominationsSize)return;let l=r-n,d=Math.min(l/e,1),p=this.denominationsWrapper.x-i*d*-1;p<10&&p>this.denominationsSize.width-this.denominationsSize.padding*2-40-this.denominationsWrapper.width&&(this.denominationsWrapper.x=p),d<1&&requestAnimationFrame(o)};requestAnimationFrame(o)}getActive(){for(let t in this.denominationContainers)if(this.denominationContainers[t].active)return this.denominationContainers[t];return null}moveRight(){let t=this.getActive();if(t){let s=t.valueNumber,i=0,e=null;for(let n in this.denominationContainers)this.denominationContainers[n].valueNumber>s&&(this.denominationContainers[n].valueNumber<=i||!i)&&(i=this.denominationContainers[n].valueNumber,e=this.denominationContainers[n].valueName);e&&this.activeContainer(e)}}moveLeft(){let t=this.getActive();if(t){let s=t.valueNumber,i=0,e=null;for(let n in this.denominationContainers)this.denominationContainers[n].valueNumber<s&&(this.denominationContainers[n].valueNumber>=i||!i)&&(i=this.denominationContainers[n].valueNumber,e=this.denominationContainers[n].valueName);e&&this.activeContainer(e)}}removeRotateAnimate(){if(this.animationFrameId)try{cancelAnimationFrame(this.animationFrameId)}catch{}}disableDenomination(){for(let t in this.denominationContainers)if(this.denominationContainers[t].active){this.denominationContainers[t].active=!1,this.denominationContainers[t].zIndex=340;let s=this.denominationContainers[t].scale.x,i=()=>{if(!(!this.denominationContainers||!this.denominationContainers[t]||!this.denominationSize))if(s>1){s-=.02,this.denominationContainers[t].scale.set(s,s);let e=this.denominationSize.activeHeight*s;this.denominationContainers[t].y=this.denominationSize.activeHeight-e,requestAnimationFrame(i)}else this.denominationContainers[t].getChildByName("denominationActive").visible=!1};this.scaleAction&&i()}}checkDisableArrow(t){let i=this.denominationContainers[t].valueNumber,e=!0,n=!0;for(let o in this.denominationContainers)this.denominationContainers[o].valueNumber<i&&(e=!1),this.denominationContainers[o].valueNumber>i&&(n=!1);e?(this.leftArrow.texture=this.assets.gameAssets.coinToss.denominationLeftArrowD,this.leftArrow.cursor="not-allowed"):(this.leftArrow.texture=this.assets.gameAssets.coinToss.denominationLeftArrow,this.leftArrow.cursor="pointer"),n?(this.rightArrow.texture=this.assets.gameAssets.coinToss.denominationRightArrowD,this.rightArrow.cursor="not-allowed"):(this.rightArrow.texture=this.assets.gameAssets.coinToss.denominationRightArrow,this.rightArrow.cursor="pointer")}activeContainer(t,s=!0){if(this.denominationContainers[t].active)return;s&&this.assets.gameAssets.coinToss.soundDenominationNext.play({loop:!1,singleInstance:!0}),this.disableDenomination(),this.removeRotateAnimate(),this.checkDisableArrow(t);let i=this.denominationContainers[t];this.betting(i.valueNumber),this.denominationsWrapper.x*-1>i.x?this.moveWrapperLeft():i.width+i.x+this.denominationsWrapper.x>this.denominationsSize.width-this.denominationsSize.padding*2&&this.moveWrapperRight(),i.active=!0,i.zIndex=341;let e=i.getChildByName("denominationActive");e.visible=!0;let n=1,o=i.y,r=.02,l=1.2,d=()=>{if(!(!e||!this.denominationSize)){if(e.rotation>=360?e.rotation=0:e.rotation+=.15,n<l&&this.scaleAction){n+=r,i.scale.set(n,n);let p=this.denominationSize.height*n;i.y=this.denominationSize.height-p}this.animationFrameId=requestAnimationFrame(d)}};this.scaleAction&&d()}addDenomination(t,s,i=0,e=0){let n=J(t,s,i,e,this.denominationSize.width,this.denominationSize.height,340,!0,this.denominationSize.activeWidth,this.denominationSize.activeHeight,o=>{this.activeContainer(o)});this.denominationContainers[s]=n,this.denominationsWrapper?.addChild(n)}destroy(){this.denominationsContainer?.destroy(),this.denominationsContainer=null,this.denominationsMaskWrapper?.destroy(),this.denominationsMaskWrapper=null,this.denominationsWrapper?.destroy(),this.denominationsWrapper=null}};var pt,ii=new Uint8Array(16);function Tt(){if(!pt&&(pt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pt(ii)}var b=[];for(let a=0;a<256;++a)b.push((a+256).toString(16).slice(1));function qt(a,t=0){return b[a[t+0]]+b[a[t+1]]+b[a[t+2]]+b[a[t+3]]+"-"+b[a[t+4]]+b[a[t+5]]+"-"+b[a[t+6]]+b[a[t+7]]+"-"+b[a[t+8]]+b[a[t+9]]+"-"+b[a[t+10]]+b[a[t+11]]+b[a[t+12]]+b[a[t+13]]+b[a[t+14]]+b[a[t+15]]}var ei=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),vt={randomUUID:ei};function ni(a,t,s){if(vt.randomUUID&&!t&&!a)return vt.randomUUID();a=a||{};let i=a.random||(a.rng||Tt)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){s=s||0;for(let e=0;e<16;++e)t[s+e]=i[e];return t}return qt(i)}var Q=ni;var m=class m{static addHistory(t){Array.isArray(t)?(m.history.push(...t),m.history.length>=m.maxHistory&&m.history.splice(0,m.history.length-m.maxHistory)):(m.history.push(t),m.history.length>=m.maxHistory&&m.history.shift()),m.history$.next(m.history),m.iniPercent(),m.iniBoard()}static iniBoard(){let t=[],s=[];m.history.forEach(i=>{s.length&&s[s.length-1].isWhite!==i.whiteIcon&&(t.push(JSON.parse(JSON.stringify(s))),s.splice(0,s.length)),s.push({isWhite:i.whiteIcon,red:i.red}),s.length===6&&(t.push(JSON.parse(JSON.stringify(s))),s.splice(0,s.length))}),s.length&&t.push(s),t.length>15&&t.splice(0,t.length-15),this.historyBoard$.next(t)}static iniPercent(){let t={even:0,fourRed:0,fourWhite:0,twoRedTwoWhite:0,odd:0,threeRedOneWhite:0,oneRedThreeWhite:0};m.history.forEach(i=>{i.whiteIcon?t.even++:t.odd++,i.red===4?t.fourRed++:i.red===0?t.fourWhite++:i.red===2?t.twoRedTwoWhite++:i.red===3?t.threeRedOneWhite++:i.red===1&&t.oneRedThreeWhite++});let s={even:Math.floor(t.even/m.history.length*100),fourRed:Math.floor(t.fourRed/m.history.length*100),fourWhite:Math.floor(t.fourWhite/m.history.length*100),twoRedTwoWhite:Math.floor(t.twoRedTwoWhite/m.history.length*100),odd:Math.ceil(t.odd/m.history.length*100),threeRedOneWhite:Math.ceil(t.threeRedOneWhite/m.history.length*100),oneRedThreeWhite:Math.ceil(t.oneRedThreeWhite/m.history.length*100)};m.historyPercent$.next(s)}static randomHistory(){for(let t=0;t<500;t++)m.addRandomHistory()}static addRandomHistory(t=0){let s=m.randomRed(),i=s!==3&&s!==1,e={red:s,white:4-s,whiteIcon:i,id:Q(),createAt:new Date().toISOString()};return setTimeout(()=>{m.addHistory(e)},t),s}};m.history=[],m.history$=new E(1),m.historyPercent$=new E(1),m.historyBoard$=new E(1),m.maxHistory=1e3,m.randomRed=()=>{let t=0;for(let s=0;s<4;s++)Math.random()>.5&&t++;return t};var k=m;var mt=class{constructor(t){this.container=t,this.historyContainer=new y,this.backgroundGraphic=new f,this.evenContainer=new y,this.oddContainer=new y,this.assets=u.getInstance(),this.tableWidth=1467,this.tablePadding=18,this.coinPadding=3,this.maxCoin=30,this.coinWidth=(this.tableWidth-this.coinPadding*this.maxCoin-this.tablePadding*2)/this.maxCoin,this.textStyle=new v({fontFamily:this.assets.gameAssets.coinToss.notoSerif.family,fontSize:30,fill:"#f9f5f3",dropShadow:!0,dropShadowColor:"#1b181a",dropShadowBlur:10,dropShadowAlpha:.8,dropShadowDistance:0,dropShadowAngle:4,stroke:"#1b181a",strokeThickness:2}),this.isDestroy=!1,this.startTime=null,this.historyContainer.sortableChildren=!0,this.backgroundGraphic.zIndex=1,this.historyContainer.zIndex=h.tableHistory.i,this.historyContainer.y=1524,this.historyContainer.x=1040,this.backgroundGraphic.beginFill(3343617,.5),this.backgroundGraphic.drawRoundedRect(0,0,1467,53,27),this.backgroundGraphic.endFill(),this.historyContainer?.addChild(this.backgroundGraphic),this.container.addChild(this.historyContainer),this.drawMessageShape(),this.animationLastCoin(),this.historySubscription=k.history$.subscribe(s=>{s.slice(-30).forEach(e=>{this.historyContainer?.getChildByName(e.id)||this.addHistory(e.red,e.white,e.id)})})}drawMessageShape(){this.messageShape=new f,this.messageShape.beginFill(65536),this.messageShape.drawRoundedRect(0,0,315,80,15);let t=document.createElement("canvas");t.width=1,t.height=100;let s=t.getContext("2d"),i=s.createLinearGradient(0,0,0,100);i.addColorStop(0,"#905038"),i.addColorStop(.4,"#fdff6c"),i.addColorStop(.5,"#f3fb66"),i.addColorStop(.6,"#c4cb56"),i.addColorStop(1,"#feff6d"),s.fillStyle=i,s.fillRect(0,0,1,100);let e=N.from(t);this.messageShape.lineStyle({width:5,color:16711532,texture:e}),this.messageShape.drawRoundedRect(0,0,315,80,15),this.messageShape.endFill(),this.messageShape.beginFill(65536),this.messageShape.drawPolygon([315/2,110,315/2-35,80,315/2+35,80]),this.messageShape.lineStyle({width:5,color:16711532,texture:e}),this.messageShape.endFill(),this.messageShape.lineStyle(5,65536),this.messageShape.moveTo(315/2-29,80),this.messageShape.lineTo(315/2+29,80),this.messageShape.endFill(),this.messageContainer=new y,this.messageContainer.addChild(this.messageShape);let n=new C("#1234567",this.textStyle);n.name="textIDData",n.anchor.set(.5,0),n.x=this.messageContainer.width/2,n.y=0,this.messageContainer?.addChild(n);let o=new C("CH\u0102\u0303N",this.textStyle);o.name="oddEvenData",o.anchor.set(0,0),o.x=30,o.y=40,this.messageContainer?.addChild(o);let r=new C("0",this.textStyle);r.name="oddText",r.anchor.set(0,0),r.x=210,r.y=40,this.messageContainer?.addChild(r);let l=new C("0",this.textStyle);l.name="evenText",l.anchor.set(0,0),l.x=280,l.y=40,this.messageContainer?.addChild(l);let d=new c(this.assets.gameAssets.coinToss.coin02);d.width=37,d.height=37,d.y=40,d.x=170,this.messageContainer?.addChild(d);let p=new c(this.assets.gameAssets.coinToss.coin01);p.width=37,p.height=37,p.y=40,p.x=240,this.messageContainer?.addChild(p),this.coinAnimationBorder=new f,this.coinAnimationBorder.lineStyle({width:5,color:16711532,texture:e}),this.coinAnimationBorder.drawCircle(0,0,this.coinWidth/2),this.coinAnimationBorder.name="coinAnimationBorder",this.coinAnimationBorder.zIndex=510,this.coinAnimationBorder.visible=!1,this.historyContainer?.addChild(this.coinAnimationBorder),this.messageContainer.visible=!1,this.historyContainer?.addChild(this.messageContainer)}showCoinInfo(t){this.messageContainer.getChildByName("textIDData").text=("#"+t.coinId).toUpperCase(),this.messageContainer.getChildByName("oddEvenData").text=t.isRed?"LE\u0309":"CH\u0102\u0303N",this.messageContainer.getChildByName("oddText").text=t.red.toString(),this.messageContainer.getChildByName("evenText").text=t.white.toString(),this.messageContainer.visible=!0,this.messageContainer.x=t.x+t.width/2-this.messageShape.width/2,this.messageContainer.y=t.y-this.messageShape.height}hideCoinInfo(){this.messageContainer.visible=!1}removeFirstCoin(){if(!this.historyContainer?.children||!this.historyContainer?.children.length)return;let t=this.historyContainer?.children.filter(o=>o.isCoin);if(!t||!t.length)return;let s=t.reduce((o,r)=>o.coinIndex<r.coinIndex?o:r);this.historyContainer?.removeChild(s),s?.destroy();let i;this.historyContainer?.children.filter(o=>o.isCoin).forEach(o=>{o.coinIndex-=1,o.y=4});let e=[],n=o=>{if(!this.historyContainer)return;i||(i=o);let r=(o-i)/500;this.historyContainer?.children.filter(l=>l.isCoin).forEach((l,d)=>{let p=l;p&&p.isCoin&&(e[d]||e?.push(this.tablePadding+(this.coinPadding+this.coinWidth)*(p.coinIndex+1)),p.x=e[d]-(this.coinWidth+this.coinPadding)*r)}),r<1&&requestAnimationFrame(n)};requestAnimationFrame(n)}addHistory(t,s,i){let e=t!==3&&t!==1,n=new c(this.assets.gameAssets.coinToss[e?"coin01":"coin02"]);n.isCoin=!0,n.coinIndex=this.totalCoin()||0,n.isRed=!e,n.name=i,n.red=t,n.white=s,n.coinId=Math.random().toString(36).substring(2,8),n.coinIndex+1>this.maxCoin&&(this.removeFirstCoin(),n.coinIndex-=1),n.width=this.coinWidth,n.height=this.coinWidth,n.x=this.tablePadding+(this.coinPadding+this.coinWidth)*n.coinIndex,n.y=4,n.zIndex=2,n.cursor="pointer",n.eventMode="dynamic",n.on("pointerenter",()=>{this.showCoinInfo(n)}),n.on("pointerout",()=>{this.hideCoinInfo()}),this.historyContainer?.addChild(n)}totalCoin(){return this.historyContainer?.children.filter(t=>t.isCoin).length}animationLastCoin(){if(!(!this.historyContainer||!this.coinAnimationBorder)&&!this.isDestroy){let t=this.historyContainer?.children.filter(i=>i.isCoin);if(!t||!t.length){this.lastCoinAnimationId=requestAnimationFrame(this.animationLastCoin.bind(this));return}let s=t.reduce((i,e)=>i.coinIndex>e.coinIndex?i:e);if(!s)this.lastCoinAnimationId=requestAnimationFrame(this.animationLastCoin.bind(this));else{this.coinAnimationBorder.visible=!0,this.coinAnimationBorder.x=s.x+s.width/2,this.coinAnimationBorder.y=s.y+s.height/2,this.startTime||(this.startTime=performance.now());let i=Math.sin((performance.now()-this.startTime)/150)*10;s.y=4+i,this.coinAnimationBorder.y=s.y+s.height/2,this.lastCoinAnimationId=requestAnimationFrame(this.animationLastCoin.bind(this))}}}destroy(){this.isDestroy=!0,this.backgroundGraphic?.destroy(),this.backgroundGraphic=null,this.historyContainer?.destroy(),this.historyContainer=null,this.evenContainer?.destroy(),this.evenContainer=null,this.oddContainer?.destroy(),this.oddContainer=null,this.messageShape?.destroy(),this.messageShape=null,this.messageContainer?.destroy(),this.messageContainer=null,this.coinAnimationBorder?.destroy(),this.coinAnimationBorder=null,this.historySubscription?.unsubscribe(),this.lastCoinAnimationId&&cancelAnimationFrame(this.lastCoinAnimationId)}};var si={0:{x:481,y:1548},1:{x:732,y:219},2:{x:242,y:470},3:{x:103,y:856},4:{x:197,y:1317},5:{x:3220,y:734},6:{x:3193,y:1210}},yt=class{set position(t){this._position=t,this.myPlayerContainer.playerPosition=t}get position(){return this._position}constructor(t){this.player=t,this.myPlayerContainer=new y,this._position=-1,this.assets=u.getInstance(),this.avatarContainer=new y,this.textStylePlayerMainName=new v({fontFamily:this.assets.gameAssets.coinToss.notoSerif.family,fontSize:37,fill:["#fffcea","#fffadb","#fff7ca"],dropShadow:!0,stroke:"#654d3c",strokeThickness:7}),this.textStylePlayerName=new v({fontFamily:this.assets.gameAssets.coinToss.notoSerifBold.family,fontSize:33,fill:"#ffffff",dropShadow:!0,dropShadowColor:"#433531",dropShadowBlur:10,dropShadowAlpha:.8,dropShadowDistance:0,dropShadowAngle:4,stroke:"#433531",strokeThickness:2}),this.textStylePlayerBalance=new v({fontFamily:this.assets.gameAssets.coinToss.notoSerifBold.family,fontSize:45,fill:"#fcf27d",dropShadow:!0,dropShadowColor:"#a08e56",dropShadowBlur:5,dropShadowAlpha:.8,dropShadowDistance:0,dropShadowAngle:0,stroke:"#fcf27d",strokeThickness:1}),this.avatarContainer.sortableChildren=!0,this.myPlayerContainer.isMain=t.isMain,this.myPlayerContainer.name=t.id,this.myPlayerContainer.playerPosition=-1,this.myPlayerContainer.sortableChildren=!0,this.avatar=new c(N.from(this.assets.assetsImg+"avatar/"+t.avatar)),this.avatar.name=h.player.o.avatar.n,this.myPlayerContainer.visible=!1,this.myPlayerContainer.alpha=0,t.isMain?this.mainSize():this.playerSize(),this.avatar.zIndex=10,this.avatarContainer.name=h.player.o.avatar.container.n,this.avatarContainer.addChild(this.avatar),this.avatarContainer.addChild(this.avatarBorder),this.myPlayerContainer.addChild(this.avatarContainer)}fadeInMyPlayerContainer(t=0){return this.myPlayerContainer.visible=!0,new Promise(s=>{if(this.myPlayerContainer.alpha===1||t<0||t>6)return s(!0);this.position=t;let{x:i,y:e}=si[this.position.toString()];this.myPlayerContainer.y=e,this.myPlayerContainer.x=i;let n=0,o=1e3,r=50,l=setInterval(()=>{if(!this.myPlayerContainer)return clearInterval(l);n+=r,this.myPlayerContainer.alpha=0+n/o,n>=o&&(this.myPlayerContainer.alpha=1,clearInterval(l),s(!0))},r)})}fadeOutMyPlayerContainer(){return new Promise(t=>{if(this.myPlayerContainer.alpha===0)return t(!0);let s=0,i=1e3,e=50,n=setInterval(()=>{if(!this.myPlayerContainer)return clearInterval(n);s+=e,this.myPlayerContainer.alpha=1-s/i,s>=i&&(this.myPlayerContainer.alpha=0,this.myPlayerContainer.visible=!1,clearInterval(n),this.position=-1,t(!0))},e)})}mainSize(){this.myPlayerContainer.y=1548,this.myPlayerContainer.x=481,this.fadeInMyPlayerContainer().then(),this.avatarBorder=new c(this.assets.gameAssets.coinToss.avatarBorder02),this.avatarBorder.zIndex=20,this.avatar.width=234,this.avatar.height=234,this.avatarBorder.width=274,this.avatarBorder.height=274,this.avatarBorder.x=50,this.avatar.x=70,this.avatar.y=20;let t=this.player.name;t=t.charAt(0).toUpperCase()+t.slice(1);let s=new C(t,this.textStylePlayerMainName);s.zIndex=40,s.anchor.set(.5,0),s.x=370/2,s.y=this.avatarBorder.height-50-24,this.myPlayerContainer?.addChild(s);let i=new f;i.beginFill(0,.4),i.drawRoundedRect(0,0,s.width+70,50,25),i.endFill(),i.zIndex=30,i.x=(370-(s.width+70))/2,i.y=this.avatarBorder.height-50-24,this.myPlayerContainer.addChild(i);let e=new f;e.beginFill(2170404),e.drawRoundedRect(0,0,370,80,15);let n=document.createElement("canvas");n.width=1,n.height=80;let o=n.getContext("2d"),r=o.createLinearGradient(0,0,0,100);r.addColorStop(0,"#fff3ca"),r.addColorStop(.1,"#c59155"),r.addColorStop(.4,"#fbe9bd"),r.addColorStop(.5,"#fff0b7"),r.addColorStop(.7,"#61493c"),r.addColorStop(1,"#fae6af"),o.fillStyle=r,o.fillRect(0,0,1,100);let l=N.from(n);e.lineStyle({width:5,color:16443055,texture:l}),e.drawRoundedRect(0,0,370,80,15),e.endFill(),e.name=h.player.o.balance.background.n,e.zIndex=50,e.y=i.y+i.height,this.myPlayerContainer?.addChild(e);let d;Number.isInteger(this.player.balance)?d=this.player.balance.toLocaleString():d=parseFloat(this.player.balance.toFixed(2)).toLocaleString();let p=new C(d,this.textStylePlayerBalance);p.zIndex=60,p.anchor.set(.5,0),p.x=e.width/2,p.y=e.y+15,this.myPlayerContainer?.addChild(p)}playerSize(){this.myPlayerContainer.y=500,this.avatarBorder=new c(this.assets.gameAssets.coinToss.avatarBorder01),this.avatarBorder.zIndex=20,this.avatarBorder.width=216,this.avatarBorder.height=216,this.avatar.width=200,this.avatar.height=200,this.avatar.y=8,this.avatar.x=8;let t=new f;t.beginFill(0,.4),t.drawRoundedRect(0,0,200,40,10),t.endFill(),t.zIndex=30,t.x=17,t.y=176,this.myPlayerContainer.addChild(t);let s=this.player.name;s=s.charAt(0).toUpperCase()+s.slice(1),s.length>7&&(s=s.slice(0,7)+"...");let i=new C(s,this.textStylePlayerName);i.zIndex=40,i.anchor.set(.5,0),i.x=217/2,i.y=t.y-2,this.myPlayerContainer?.addChild(i);let e=new c(this.assets.gameAssets.coinToss.balance01);e.zIndex=50,e.width=this.avatarBorder.width,e.height=70,e.y=i.y+i.height,this.myPlayerContainer?.addChild(e);let n;this.player.balance>9999?n="9,999+":Number.isInteger(this.player.balance)?n=this.player.balance.toLocaleString():n=parseFloat(this.player.balance.toFixed(2)).toLocaleString();let o=new C(n,this.textStylePlayerBalance);o.zIndex=60,o.anchor.set(.5,0),e.name=h.player.o.balance.background.n,o.x=e.width/2,o.y=e.y+8,this.myPlayerContainer?.addChild(o)}destroy(){this.avatar?.destroy(),this.avatar=null,this.avatarBorder?.destroy(),this.avatarBorder=null,this.avatarContainer?.destroy(),this.avatarContainer=null,this.myPlayerContainer?.destroy(),this.myPlayerContainer=null}};var K=["1cf504b8-693f-43a9-a15a-c49462035b39.88351.png","03e1be8a-3170-41aa-881c-8b194120c38a.16760.png","4d977f86-c287-4ec8-83f4-1471e71ab76e.d1ec3.png","4db02126-ef26-4ff0-92c5-14f34b2f6263.70bca.png","5fe62372-9276-400c-99f2-f496eee3ba2d.77b09.png","9b2cafba-dc29-48da-acc5-5304d7749dfe.109cd.png","64dc78b3-befb-4704-a11f-faa99ac91e39.a91f1.png","113e2a43-2afc-4655-a248-4b4b7a0d976c.3242d.png","135f32b9-c426-4648-8087-4a8286cceac6.130e1.png","493ffc87-ffa3-44d8-8df8-a6465351ed9c.160e1.png","670c79e1-35bd-4d66-8e82-54ae0b449456.89109.png","0952b3e9-b6a4-4666-9cb9-f330c53c576a.c01bf.png","968a06de-7ab9-4d4d-a4a2-f111c62d4957.c56ef.png","71905265-1bb7-4fd8-b6d0-0be62dd62781.1e233.png","a01e2018-d42a-4cfb-8332-d9456d3a60b9.89ac0.png","a1d79def-1d31-4a74-9bb3-c4c6de929c31.1f2bc.png","a82798bc-7ff8-443d-bb44-5ad3c28a4a6d.552a2.png","bbb297cd-ac54-4bdd-b15c-007681e5ba44.3a591.png","c3ec9215-7536-4c80-a681-976ac3aecb96.dd097.png","c6d35930-b7ae-4517-8ce5-dc682c3ef55d.d4880.png","c172905e-e468-4e49-a2b0-74deb7c3d17a.21a00.png","e7d1edb4-210a-4404-a125-389d27cae646.727a8.png","ed224165-3612-4289-8d5a-975fdf801b18.41d45.png","f36b1b13-fdbe-4dcd-ac48-a497d7a76e48.b0d15.png","f44277d9-a231-43f7-aed4-f841edc89187.02a04.png"];var gt=class{constructor(t){this.container=t,this.playerContainer=new y,this.assets=u.getInstance(),this.otherPlayer=new c(this.assets.gameAssets.coinToss.otherPlayer),this.listPlayerContainer={},this.mainPlayerID=Math.random().toString(36).substr(2,10),this.playerContainer.zIndex=h.player.i,this.playerContainer.name=h.player.n,this.otherPlayer.width=240,this.otherPlayer.height=240,this.otherPlayer.position.set(2770,1594),this.playerContainer.addChild(this.otherPlayer),this.playerContainer.sortableChildren=!0,this.container.addChild(this.playerContainer),this.addPlayer({id:this.mainPlayerID,name:Math.random().toString(36).substr(2,15),balance:Math.floor(Math.random()*1e5)*100+Math.random(),avatar:K[Math.floor(Math.random()*K.length)],isMain:!0});for(let s=0;s<100;s++)this.addPlayer({id:Math.random().toString(36).substr(2,10),name:Math.random().toString(36).substr(2,7),balance:Math.floor(Math.random()*1e3)*10+Math.random(),avatar:K[Math.floor(Math.random()*K.length)],isMain:!1});setInterval(()=>{let s=this.getPlayerIdByPosition(Math.floor(Math.random()*6)+1);s&&this.playerLeave(s)},3e3)}addPlayer(t){let s=new yt(t);if(this.playerContainer.addChild(s.myPlayerContainer),this.listPlayerContainer[t.id]=s,!t.isMain){let i=this.getSpacePosition(!0);i&&this.showPlayer(t.id,i)}}getPlayerIdByPosition(t){return Object.keys(this.listPlayerContainer).find(s=>this.listPlayerContainer[s].position===t)}playerLeave(t){let s=this.listPlayerContainer[t].position;this.removePlayer(t).subscribe(i=>{if(s>=0){let e=this.getRandomPlayerWaiting();e&&this.showPlayer(e.player.id,s)}})}getRandomPlayerWaiting(){let t=this.getPlayerWaiting();return t.length>0?t[Math.floor(Math.random()*t.length)]:null}getPlayerWaiting(){return Object.keys(this.listPlayerContainer).filter(t=>this.listPlayerContainer[t].position===-1).map(t=>this.listPlayerContainer[t])}getSpacePosition(t=!1){let s=this.playerContainer.children.filter(e=>e.playerPosition!=-1).map(e=>e.playerPosition),i=[1,2,3,4,5,6].filter(e=>!s.includes(e));return t?i[Math.floor(Math.random()*i.length)]:i}showPlayer(t,s){if(this.listPlayerContainer[t].player.isMain&&(s=0),this.listPlayerContainer[t].position>=0)return!0;s=s;let i;for(let e in this.listPlayerContainer)if(this.listPlayerContainer[e].position===s){i=e;break}return i?this.listPlayerContainer[i].fadeOutMyPlayerContainer().then(e=>{this.listPlayerContainer[t].fadeInMyPlayerContainer(s).then()}):this.listPlayerContainer[t].fadeInMyPlayerContainer(s).then(),!0}removePlayer(t){return V(this.listPlayerContainer[t].fadeOutMyPlayerContainer()).pipe(F(s=>{this.listPlayerContainer[t].destroy(),delete this.listPlayerContainer[t]}))}destroy(){Object.keys(this.listPlayerContainer).forEach(t=>{this.listPlayerContainer[t].destroy(),delete this.listPlayerContainer[t]}),this.playerContainer?.destroy(),this.playerContainer=null}};var tt=class{constructor(t,s,i,e,n,o=Q()){this.playerID=t,this.amount=s,this.playerPosition=i,this.betPosition=e,this.denominationCoin=n,this.coinId=o}};var At,oi=(a,t=!0)=>{if(At&&t)return At;{let s=a.getChildByName(h.bettingSpot.n);return At=s,s}},Lt=(a,t)=>{let s=oi(a),i=h.bettingSpot.spotArea.n(t);return s.getChildByName(i)};var $t=(a,t,s,i)=>{let e=Math.random()*(s-a),n=Math.random()*(i-t);return{x:e,y:n}};var Vt=(a,t)=>t.angle==90?{height:a.width,width:a.height}:a;var Ct=(a,t)=>{let s=a.getBounds(),i=t.scale;return Bt(U({},Vt({width:s.width*(1/i.x),height:s.height*(1/i.y)},t)),{containerScale:i})};var jt=(a,t)=>{let s=a.toLocal(new _(0,0),t),i=a.scale,e=a.anchor,n={x:0,y:0};if(e){let o=a.parent,r=Ct(o,t);n={x:r.width*e.x,y:r.height*e.y}}return{x:s.x*-1*i.x-n.x,y:s.y*-1*i.y-n.y,anchorRemovePosition:n,anchor:e,scale:i,position:s}};var it=(a,t)=>U(U({},jt(a,t)),Ct(a,t));var W=(()=>{let t=class t{static tweenTo(i,e,n,o,r,l,d,p){i[l]=!1;let O={object:i,property:e,propertyBeginValue:i[e],target:n,easing:r,time:o,animationName:l,change:d,complete:p,start:Date.now()};return t.tweening.push(O),O}static lerp(i,e,n){return i*(1-n)+e*n}static backout(i){return e=>--e*e*((i+1)*e+i)+1}};t.tweening=[];let a=t;return a})();var ft=class{constructor(t){this.container=t,this.listCoinBet=[],this.listCoinContainer=new y,this.coinSize=62,this.listCoinContainer.zIndex=h.listCoinBet.i,this.container.addChild(this.listCoinContainer),this.playerContainer=this.container.getChildByName("playerContainer"),this.dealer=this.container.getChildByName(h.dealer.n),this.spotsContainer=this.container.getChildByName("spotsContainer"),this.denominationsContainer=this.container.getChildByName("denominationsContainer"),this.denominationsMaskWrapper=this.denominationsContainer.getChildByName("denominationsMaskWrapper"),this.denominationsWrapper=this.denominationsMaskWrapper.getChildByName("denominationsWrapper");let s={},i=n=>{s[n]&&clearTimeout(s[n]),s[n]=setTimeout(()=>{this.coinWin(n),delete s[n]},200)},e=()=>{this.listCoinBet.filter(n=>(n.denominationCoin?.xPosition||n.denominationCoin?.yPosition)&&(n.denominationCoin?.x!=n.denominationCoin?.xPosition||n.denominationCoin?.y!=n.denominationCoin?.yPosition)).forEach(n=>{n.denominationCoin.x=n.denominationCoin.xPosition,n.denominationCoin.y=n.denominationCoin.yPosition,(n.denominationCoin||{}).xPosition&&(n.denominationCoin||{}).yPosition&&(n.denominationCoin.xPosition=0,n.denominationCoin.yPosition=0),(n.denominationCoin||{}).xPositionAnimationDealerSpot&&(n.denominationCoin||{}).xPositionAnimationDealerSpot&&i(n.betPosition),((n.denominationCoin||{}).xPositionAnimationDealer&&(n.denominationCoin||{}).yPositionAnimationDealer||(n.denominationCoin||{}).xPositionAnimationWin&&(n.denominationCoin||{}).yPositionAnimationWin)&&(n.denominationCoin.xPosition=0,n.denominationCoin.yPosition=0,this.removeCoin(n))}),this.animationID=requestAnimationFrame(e)};this.animationID=requestAnimationFrame(e)}dealerToWinSpot(t){let s=this.getDealerPoint();this.listCoinBet.filter(i=>i.betPosition===t).forEach(i=>{let e=this.playerContainer.getChildByName(i.playerID),n=J(P[i.amount].color,P[i.amount].name,0,P[i.amount].value,this.coinSize,this.coinSize,6e3,!1);this.listCoinBet.push(new tt(i.playerID,i.amount,e.playerPosition,t,n)),n.x=s.x,n.y=s.y;let o=this.getRandomSpotPosition(n,t);this.moveDenominationAnimation(n,o.x,o.y,"xPositionAnimationDealerSpot","yPositionAnimationDealerSpot"),this.listCoinContainer.addChild(n)})}coinWin(t){let s={};this.listCoinBet.filter(i=>i.betPosition===t).forEach(i=>{let e=s[i.playerID];e||(s[i.playerID]=this.playerContainer.getChildByName(i.playerID),e=s[i.playerID]);let n=it(e,this.container),o=new _(n.x+n.width/2-this.coinSize/2,n.y+n.height/2);this.moveDenominationAnimation(i.denominationCoin,o.x,o.y,"xPositionAnimationWin","yPositionAnimationWin")})}getDealerPoint(){let t=it(this.dealer,this.container);return new _(t.x+t.width/2-this.coinSize/2,t.y+t.height-90)}coinToDealer(t){let s=this.getDealerPoint();Array.isArray(t)?t.forEach(i=>{this.listCoinBet.filter(e=>e.betPosition===i).forEach(e=>{this.moveDenominationAnimation(e.denominationCoin,s.x,s.y,"xPositionAnimationDealer","yPositionAnimationDealer")})}):this.listCoinBet.filter(i=>i.betPosition===t).forEach(i=>{this.moveDenominationAnimation(i.denominationCoin,s.x,s.y,"xPositionAnimationDealer","yPositionAnimationDealer")})}removeCoin(t){t.denominationCoin?.destroy(),t.denominationCoin=null,this.listCoinBet.splice(this.listCoinBet.map(s=>s.coinId).indexOf(t.coinId),1)}getRandomSpotPosition(t,s){let i=Lt(this.container,s),e=it(i,this.container),n=$t(t.width,t.height,e.width,e.height);return{x:n.x+e.x,y:n.y+e.y}}moveDenominationAnimation(t,s,i,e="xPositionAnimation",n="yPositionAnimation",o=800){t.xPosition=t.x,t.yPosition=t.y,W.tweenTo(t,"xPosition",s,800,W.backout(.5),e),W.tweenTo(t,"yPosition",i,800,W.backout(.5),n)}addBet(t,s,i){let e=this.playerContainer.getChildByName(t),n=J(P[s].color,P[s].name,0,P[s].value,this.coinSize,this.coinSize,6e3,!1);if(this.listCoinBet.push(new tt(t,s,e.playerPosition,i,n)),e.isMain){let o=this.denominationsWrapper.getChildByName(h.denomination.item.n(s)),r=o.getChildByName(h.denomination.item.active.n);r.rotation=0;let l=it(o,this.container);n.position.set(l.x+l.width/(r.scale.x+1),l.y+l.height/(r.scale.y+1));let d=this.getRandomSpotPosition(n,i);this.moveDenominationAnimation(n,d.x,d.y)}this.listCoinContainer.addChild(n)}destroy(){this.listCoinBet=[],this.listCoinContainer?.destroy(),this.listCoinContainer=null,this.playerContainer?.destroy(),this.playerContainer=null,this.spotsContainer?.destroy(),this.spotsContainer=null,this.denominationsContainer?.destroy(),this.denominationsContainer=null,this.denominationsMaskWrapper?.destroy(),this.denominationsMaskWrapper=null,this.denominationsWrapper?.destroy(),this.denominationsWrapper=null,this.animationID&&cancelAnimationFrame(this.animationID)}};var Pt=a=>{let t=document.createElement("canvas");t.width=1,t.height=a;let s=t.getContext("2d"),i=s.createLinearGradient(0,0,0,a);return i.addColorStop(0,"#905038"),i.addColorStop(.4,"#fdff6c"),i.addColorStop(.5,"#f3fb66"),i.addColorStop(.6,"#c4cb56"),i.addColorStop(1,"#feff6d"),s.fillStyle=i,s.fillRect(0,0,1,a),N.from(t)},Ut=a=>{let t=document.createElement("canvas");t.width=1,t.height=a;let s=t.getContext("2d"),i=s.createLinearGradient(0,0,0,100);return i.addColorStop(0,"#100e0e"),i.addColorStop(.5,"#313131"),i.addColorStop(1,"#100e0e"),s.fillStyle=i,s.fillRect(0,0,1,a),N.from(t)};var ut=class{constructor(t){this.container=t,this.percentHistory=new y,this.tableHistory=new y,this.percentHistorySize={width:332,height:378,border:6,radius:26},this.tableHistorySize={width:936,height:378,border:6,radius:0,itemSize:(378-6)/6},this.assets=u.getInstance(),this.container.addChild(this.percentHistory),this.container.addChild(this.tableHistory),this.tableHistory.sortableChildren=!0,this.tableHistory.zIndex=h.calHistory.i+1,this.tableHistory.position.set(h.calHistory.percent.left+this.percentHistorySize.width-this.percentHistorySize.border,h.calHistory.percent.top),this.percentHistory.sortableChildren=!0,this.percentHistory.zIndex=h.calHistory.i,this.percentHistory.position.set(h.calHistory.percent.left,h.calHistory.percent.top),this.__IniPercentHistory(),this.__IniTableHistory(),this.__IniBoardData(),this.__IniPercentData()}__IniPercentData(){this.percentSubscription=k.historyPercent$.subscribe(t=>{let s=this.percentHistory.getChildByName("evenPercent"),i=this.percentHistory.getChildByName("oddPercent"),e=this.percentHistory.getChildByName("fourRed"),n=this.percentHistory.getChildByName("fourWhite"),o=this.percentHistory.getChildByName("twoRedTwoWhite"),r=this.percentHistory.getChildByName("threeRedOneWhite"),l=this.percentHistory.getChildByName("oneRedThreeWhite");s.text=`${t.even}%`,i.text=`${t.odd}%`,e.text=`${t.fourRed}%`,n.text=`${t.fourWhite}%`,o.text=`${t.twoRedTwoWhite}%`,r.text=`${t.threeRedOneWhite}%`,l.text=`${t.oneRedThreeWhite}%`})}__IniBoardData(){this.boardSubscription=k.historyBoard$.subscribe(t=>{this.tableHistory.children.filter(s=>s.name?.includes("square")).forEach(s=>{s.removeChildren()}),t.forEach((s,i)=>{s.forEach((e,n)=>{let o=this.tableHistory.getChildByName(`square-${n}-${i}`),r=this.drawHistoryCoin(!e.isWhite);r.zIndex=1;let l=new v({fontFamily:this.assets.gameAssets.coinToss.notoSerif.family,fontSize:30,fill:e.isWhite?460551:16445422}),d=new C(e.red.toString(),l);d.zIndex=2,d.anchor.set(.5,.5),d.position.set(this.tableHistorySize.itemSize/2-this.tableHistorySize.border/2,this.tableHistorySize.itemSize/2-this.tableHistorySize.border/2),o.addChild(r),o.addChild(d)})})})}destroy(){this.percentHistory?.destroy(),this.boardSubscription?.unsubscribe(),this.percentSubscription?.unsubscribe(),this.percentHistory=null}__IniTableHistory(){this.__IniTableHistoryBackground()}__IniTableHistoryBackground(){let t=new f;t.zIndex=1,t.beginFill(460291),t.lineStyle({width:this.tableHistorySize.border,color:16777215,texture:Pt(332)}),t.moveTo(0,0),t.lineTo(this.tableHistorySize.width,0),t.bezierCurveTo(this.tableHistorySize.width,0,this.tableHistorySize.width,this.tableHistorySize.radius,this.tableHistorySize.width,this.tableHistorySize.radius),t.lineTo(this.tableHistorySize.width,this.tableHistorySize.height-this.tableHistorySize.radius),t.bezierCurveTo(this.tableHistorySize.width,this.tableHistorySize.height,this.tableHistorySize.width-this.tableHistorySize.radius,this.tableHistorySize.height,this.tableHistorySize.width-this.tableHistorySize.radius,this.tableHistorySize.height),t.lineTo(0,this.tableHistorySize.height),t.lineTo(0,0),t.endFill(),this.tableHistory.addChild(t);let s=this.tableHistorySize.itemSize,i=s;for(let e=0;e<6;e++)for(let n=0;n<15;n++){let o=new y,r=new f;r.lineStyle(4,3223857,1e-4),r.drawRect(0,0,i,s),o.x=n*i+2,o.sortableChildren=!0,o.y=e*s+2,o.name=`square-${e}-${n}`,o.zIndex=40,o.addChild(r),this.tableHistory.addChild(o)}for(let e=0;e<5;e++){let n=new f;n.lineStyle(6,3947323,.4),n.zIndex=50,n.moveTo(0,0),n.lineTo(this.tableHistorySize.width-this.tableHistorySize.border,0),n.y=(e+1)*this.tableHistorySize.itemSize,n.x=this.tableHistorySize.border/2,this.tableHistory.addChild(n)}for(let e=0;e<14;e++){let n=new f;n.lineStyle(6,3947323,.4),n.zIndex=50,n.moveTo(0,0),n.lineTo(0,this.tableHistorySize.height-this.tableHistorySize.border),n.x=(e+1)*((this.tableHistorySize.width-this.tableHistorySize.border)/15),this.tableHistory.addChild(n)}}__IniPercentHistory(){this.percentTextType={white:new v({fontFamily:this.assets.gameAssets.coinToss.notoSerifBold.family,fontSize:33,fill:15724527}),black:new v({fontFamily:this.assets.gameAssets.coinToss.notoSerifBold.family,fontSize:33,fill:0})},this.__IniPercentHistoryBackground();let t=this.percentHistorySize.width-15,s=new C("0%",this.percentTextType.black);s.zIndex=100,s.name="evenPercent",s.anchor.set(1,0),s.position.set(t,13),this.percentHistory.addChild(s);let i=new C("0%",this.percentTextType.white);i.zIndex=100,i.anchor.set(1,0),i.position.set(t,4*54+10),this.percentHistory.addChild(i);let e=new C("0%",this.percentTextType.white);e.zIndex=100,e.anchor.set(1,0),e.position.set(t,1*55+5),this.percentHistory.addChild(e);let n=new C("0%",this.percentTextType.white);n.zIndex=100,n.anchor.set(1,0),n.position.set(t,2*55+5),this.percentHistory.addChild(n);let o=new C("0%",this.percentTextType.white);o.zIndex=100,o.anchor.set(1,0),o.position.set(t,3*55+5),this.percentHistory.addChild(o);let r=new C("0%",this.percentTextType.white);r.zIndex=100,r.anchor.set(1,0),r.position.set(t,5*54+7),this.percentHistory.addChild(r);let l=new C("0%",this.percentTextType.white);l.zIndex=100,l.anchor.set(1,0),l.position.set(t,6*54+7),this.percentHistory.addChild(l),i.name="oddPercent",e.name="fourRed",n.name="fourWhite",o.name="twoRedTwoWhite",r.name="threeRedOneWhite",l.name="oneRedThreeWhite",this.__IniEven(),this.__IniOdd(),this.__IniLine()}drawHistoryCoin(t,s=25){let i=new f,e=t?13056817:16777215;return i.beginFill(e),i.drawCircle(0,0,s),i.endFill(),i.x=this.tableHistorySize.itemSize/2-this.tableHistorySize.border/2,i.y=this.tableHistorySize.itemSize/2-this.tableHistorySize.border/2,i}__IniHistoryCoin(t,s,i){for(let e=0;e<t;e++){let n=this.drawHistoryCoin(!0,20);n.zIndex=100,n.x=40+e*55,n.y=i*54+25,this.percentHistory.addChild(n)}for(let e=0;e<s;e++){let n=this.drawHistoryCoin(!1,20);n.zIndex=100,n.x=40+(e+t)*55,n.y=i*54+25,this.percentHistory.addChild(n)}}__IniLine(){this.__IniHistoryCoin(4,0,1),this.__IniHistoryCoin(0,4,2),this.__IniHistoryCoin(2,2,3),this.__IniHistoryCoin(3,1,5),this.__IniHistoryCoin(1,3,6);for(let t=0;t<5;t++){let s=new f;s.lineStyle({width:6,color:16777215,texture:Ut(5),alpha:.9}),s.moveTo(0,0),s.lineTo(326,0),s.y=(t+2)*54,s.x=3,s.zIndex=20,this.percentHistory.addChild(s)}}__IniOdd(){let t=new f;t.beginFill(13056817),t.drawRect(0,0,326,49),t.endFill(),t.y=4*54+3,t.x=3,t.zIndex=30;let s=new C("Le\u0309",this.percentTextType.white);s.zIndex=40,s.position.set(20,4*54+10),this.percentHistory.addChild(s),this.percentHistory.addChild(t)}__IniEven(){let t=new f;t.zIndex=2,t.beginFill(16777215),t.moveTo(this.percentHistorySize.width,0),t.lineTo(this.percentHistorySize.radius,0),t.bezierCurveTo(0,0,0,this.percentHistorySize.radius-this.percentHistorySize.border,0,this.percentHistorySize.radius-this.percentHistorySize.border),t.lineTo(0,54),t.lineTo(this.percentHistorySize.width-this.percentHistorySize.border,54),t.lineTo(this.percentHistorySize.width-this.percentHistorySize.border,0),t.endFill(),t.x=3,t.y=3;let s=new C("Ch\u0103\u0303n",this.percentTextType.black);s.zIndex=3,s.position.set(20,13),this.percentHistory.addChild(s),this.percentHistory.addChild(t)}__IniPercentHistoryBackground(){let t=new f;t.zIndex=1,t.beginFill(460291),t.lineStyle({width:this.percentHistorySize.border,color:16777215,texture:Pt(332)}),t.moveTo(this.percentHistorySize.width,0),t.lineTo(this.percentHistorySize.radius,0),t.bezierCurveTo(0,0,0,this.percentHistorySize.radius,0,this.percentHistorySize.radius),t.lineTo(0,this.percentHistorySize.height-this.percentHistorySize.radius),t.bezierCurveTo(0,this.percentHistorySize.height,this.percentHistorySize.radius,this.percentHistorySize.height,25,this.percentHistorySize.height),t.lineTo(this.percentHistorySize.width,this.percentHistorySize.height),t.lineTo(this.percentHistorySize.width,0),t.endFill(),this.percentHistory.addChild(t)}};var xt=class{constructor(t){this.game=t,this.containerRealHeight=1898,this.containerRealWidth=3538,this.containerSpecRatio=this.containerRealWidth/this.containerRealHeight,this.tableSpecRatio=1315/607,this.dealerSpecRatio=192/243,this.container=new y,this.containerWidth=this.containerRealWidth,this.containerHeight=this.containerRealHeight,this.assets=u.getInstance(),this.graphic=new f,this.init().then()}init(){return B(this,null,function*(){this.container.sortableChildren=!0,yield this.assets.loadSuccess$.pipe(nt(1),q(1)).toPromise(),this.table=new c(this.assets.gameAssets.coinToss.table),this.table.zIndex=h.table.i,this.dealer=new c(this.assets.gameAssets.coinToss.dealer),this.dealer.zIndex=h.dealer.i,this.dealer.name=h.dealer.n,this.container.addChild(this.graphic),this.game.stage.addChild(this.container),this.container.addChild(this.table),this.container.addChild(this.dealer),this.iniContainerSize(),this.iniTableSize(),this.iniDealerSize(),this.coinTossPlate=new dt(this.container),this.bettingSpotsContains=new lt(this.container,t=>{this.assets.gameAssets.coinToss.soundCoinBet.play({singleInstance:!0,loop:!1}),this.listCoinBet.addBet(this.playerContainer.mainPlayerID,this.bettingAmount,t)}),this.tableHistory=new mt(this.container),this.playerContainer=new gt(this.container),this.denominationsContainer=new ct(this.container,t=>{this.bettingAmount=t}),this.listCoinBet=new ft(this.container),this.calHistory=new ut(this.container)})}iniSize(){this.iniContainerSize()}iniContainerSize(){let t;this.game.screen.width>this.game.screen.height||this.game.screen.width>900?(this.game.screen.width/this.game.screen.height<this.containerSpecRatio?(t=this.game.screen.width/this.containerWidth,this.container.scale.set(t)):(t=this.game.screen.height/this.containerHeight,this.container.scale.set(t)),this.container.angle=0,this.container.position.x=(this.game.screen.width-this.containerWidth*t)/2,this.container.position.y=(this.game.screen.height-this.containerHeight*t)/2,this.container.pivot.x=0,this.container.pivot.y=0):(t=this.game.screen.width/this.containerHeight,this.container.scale.set(t),this.container.pivot.x=0,this.container.pivot.y=this.containerHeight,this.container.position.x=0,this.container.position.y=(this.game.screen.height-this.containerWidth*t)/2,this.container.angle=90)}iniTableSize(){this.table.width=3138,this.table.height=this.table.width/this.tableSpecRatio,this.table.y=410,this.table.x=200}iniDealerSize(){this.dealer.width=450,this.dealer.height=this.dealer.width/this.dealerSpecRatio,this.dealer.x=1540,this.dealer.y=48}destroy(){this.coinTossPlate?.destroy(),this.bettingSpotsContains?.destroy(),this.denominationsContainer?.destroy(),this.tableHistory?.destroy(),this.container?.destroy(!0),this.playerContainer?.destroy(),this.playerContainer=null,this.listCoinBet?.destroy(),this.listCoinBet=null,this.calHistory?.destroy(),this.calHistory=null}};var wt=u.getInstance(),Xt=(a,t,s)=>{let i=new v({fontFamily:wt.gameAssets.coinToss.notoSerifBold.family,fontSize:90,fill:["#fff073","#fae882","#ffeca3","#fae882","#fff073"],dropShadow:!0,dropShadowColor:"#371600",dropShadowBlur:5,dropShadowAlpha:.8,dropShadowDistance:0,dropShadowAngle:0,stroke:"#371600",strokeThickness:1}),e=new y;e.zIndex=h.coinTossWinAnimation.i,e.name=h.coinTossWinAnimation.n,e.sortableChildren=!0;let n;Number.isInteger(s)?n=s.toLocaleString().toString():n=parseFloat(s.toFixed(2)).toLocaleString().toString(),n="+"+n;let o=new C(n,i);o.zIndex=30,o.anchor.set(.5,1),e.addChild(o);let r=t.getChildByName("avatarContainer"),l=t.getChildByName("balanceBackground"),d=r.width*2,p=d*(94/247),O=t.height,g=new c(wt.gameAssets.coinToss.winBG);g.width=d*.8,g.height=d*.8*(549/533),g.zIndex=10,g.anchor.set(.5,.5),g.x=d/2,g.y=d/2,e.addChild(g);let x=new c(wt.gameAssets.coinToss.winCoin);x.width=d*.6,x.height=d*.6*(614/539),x.zIndex=11,x.anchor.set(.5,.5),x.x=d/2,x.y=d/2,e.addChild(x);let H=(S=0,A=1,z,I,D,R)=>{let L=null,M=1e3,$=et=>{if(!g||!x)return;L||(L=et);let G=et-L,Jt=z+Math.sin(G/M*Math.PI*2)*.2,Qt=I+Math.sin(G/M*Math.PI*2)*.2,Kt=D+Math.sin(G/M*Math.PI*2)*.1*-1,ti=R+Math.sin(G/M*Math.PI*2)*.1*-1;g.scale.set(Jt,Qt),x.scale.set(Kt,ti),G<M?requestAnimationFrame($):(S++,S<=A?H(S,A,z,I,D,R):(g.scale.set(1,1),x.scale.set(1,1),g.destroy(),x.destroy(),g=null,x=null,H=null))};requestAnimationFrame($)};H(0,1,g.scale.x,g.scale.y,x.scale.x,x.scale.y),o.x=d/2;let T=O-o.height*.6;o.y=T;let It=o.height*.5,Wt=()=>{let S=0,A=2300,z=50,I=o.y,D=I-It,R=setInterval(()=>{if(!o)return clearInterval(R);S+=z,o.y=I-S/A*It,S>=A&&(o.y=D,clearInterval(R),Wt=null,o?.destroy(),o=null)},z)};Wt(),e.x=t.x+l.x-(d*1.25-l.width)/2,e.y=t.y+r.y-(d-r.width)/2,e.width=d;let w=new c(wt.gameAssets.coinToss.winVI);w.zIndex=20,w.width=d,w.height=p,w.anchor.set(.5,.5),w.x=d/2,w.alpha=0,w.y=O;let Ht=()=>{let S=0,A=300,z=20,I=setInterval(()=>{if(!w)return clearInterval(I);S+=z,w.alpha=S/A,w.width=d-S/A*(d-d*.85),w.height=p-S/A*(p-p*.85),S>=A&&(w.alpha=1,w.width=d*.85,w.height=p*.85,clearInterval(I),Ht=null,St(0,3,w.scale.x,w.scale.y))},z)};Ht();let St=(S=0,A=1,z,I)=>{let D=null,R=500,L=M=>{if(!w)return;D||(D=M);let $=M-D,et=z+Math.sin($/R*Math.PI*2)*.3,G=I+Math.sin($/R*Math.PI*2)*.3;w.scale.set(et,G),$<R?requestAnimationFrame(L):(S++,S<=A?St(S,A,z,I):(w?.destroy(),w=null,St=null))};requestAnimationFrame(L)};e.addChild(w),a.addChild(e),setTimeout(()=>{e?.destroy(),a.removeChild(e),e=null},2e3)};var Zt=(()=>{let t=class t{constructor(i){this.zone=i,this.width$=new E(1),this.height$=new E(1),this.screen$=new kt,this.zone.runOutsideAngular(()=>{Rt(window,"resize").pipe(Dt(500)).subscribe(e=>{this.getScreenSize()})}),this.getScreenSize()}getScreenSize(){this.screenWidth=window.innerWidth,this.screenHeight=window.innerHeight,this.width$.next(this.screenWidth),this.height$.next(this.screenHeight),this.screen$.next({width:this.screenWidth,height:this.screenHeight})}};t.\u0275fac=function(e){return new(e||t)(Z(j))},t.\u0275prov=st({token:t,factory:t.\u0275fac,providedIn:"root"});let a=t;return a})();var _t=(()=>{let t=class t{constructor(i,e){this.screenSize=i,this.zone=e,this.spotAnimationName={1:"oneRedThreeWhite",2:"twoRedTwoWhite",3:"threeRedOneWhite",4:"fourRed",0:"fourWhite",odd:"odd",even:"even"},k.randomHistory(),this.screenSubscription=this.screenSize.screen$.subscribe(n=>{this.gameContainer&&this.game&&(this.game.view.width=n.width,this.game.view.height=n.height,this.game.screen.width=n.width,this.game.screen.height=n.height,this.gameContainer.iniSize())})}init(){return B(this,null,function*(){yield this.zone.runOutsideAngular(()=>B(this,null,function*(){this.game=new Gt({width:this.screenSize.screenWidth,height:this.screenSize.screenHeight,backgroundAlpha:0}),this.game.ticker.add(i=>{let e=Date.now(),n=[];for(let o=0;o<W.tweening.length;o++){let r=W.tweening[o],l=Math.min(1,(e-r.start)/r.time);r.object[r.property]=W.lerp(r.propertyBeginValue,r.target,r.easing(l)),r.change&&r.change(r),l===1&&(r.object[r.property]=r.target,r.object[r.animationName]=!0,r.complete&&r.complete(r),n.push(r))}for(let o=0;o<n.length;o++)W.tweening.splice(W.tweening.indexOf(n[o]),1)}),this.assets=u.getInstance(),yield this.assets.loadSuccess$.pipe(nt(1),q(1)).toPromise(),this.assets.gameAssets.coinToss.soundtrack.play({loop:!0,singleInstance:!0}),this.gameContainer=new xt(this.game),setTimeout(()=>{this.gameContainer.coinTossPlate.plateContainer.eventMode="static",this.gameContainer.coinTossPlate.plateContainer.cursor="pointer";let i=!1;this.gameContainer.coinTossPlate.plateContainer.on("pointerdown",()=>{if(i)return;i=!0,this.gameContainer.coinTossPlate.coinContainer?.removeChildren();let e=k.addRandomHistory(3e3);this.gameContainer.coinTossPlate.addCoin(4-e,e),this.gameContainer.coinTossPlate.plateContainer.zIndex=h.plate.a,this.gameContainer.bettingSpotsContains.spotDefault(),V(this.gameContainer.coinTossPlate.shake()).pipe(F(()=>{if([0,2,4].indexOf(e)!==-1){let o=this.gameContainer.bettingSpotsContains.spot01;this.gameContainer.bettingSpotsContains.AddSpotWinAnimationV2(o,6e3).then()}else{let o=this.gameContainer.bettingSpotsContains.spot02;this.gameContainer.bettingSpotsContains.AddSpotWinAnimationV2(o,6e3).then()}let n;switch(e){case 4:{n=this.gameContainer.bettingSpotsContains.spot03;break}case 3:{n=this.gameContainer.bettingSpotsContains.spot05;break}case 2:{n=this.gameContainer.bettingSpotsContains.spot06;break}case 1:{n=this.gameContainer.bettingSpotsContains.spot07;break}case 0:{n=this.gameContainer.bettingSpotsContains.spot04;break}}this.gameContainer.bettingSpotsContains.AddSpotWinAnimationV2(n,6e3).then()}),X(n=>this.gameContainer.coinTossPlate.reveal()),X(n=>this.gameContainer.coinTossPlate.hidePlate01()),F(()=>{switch(this.gameContainer.coinTossPlate.plateContainer.zIndex=h.plate.i,[0,2,4].indexOf(e)!==-1?this.gameContainer.listCoinBet.coinToDealer(2):this.gameContainer.listCoinBet.coinToDealer(1),e){case 0:{this.gameContainer.listCoinBet.coinToDealer([3,4,5,6]);break}case 1:{this.gameContainer.listCoinBet.coinToDealer([3,4,5,7]);break}case 2:{this.gameContainer.listCoinBet.coinToDealer([3,4,6,7]);break}case 3:{this.gameContainer.listCoinBet.coinToDealer([3,5,6,7]);break}case 4:{this.gameContainer.listCoinBet.coinToDealer([4,5,6,7]);break}}}),q(2e3),F(()=>{let n=0;if(this.gameContainer.listCoinBet.listCoinBet.forEach(o=>{o.betPosition===1||o.betPosition===2?n+=o.amount*1.96:o.betPosition===3||o.betPosition===7?n+=o.amount*14.4:o.betPosition===4||o.betPosition===6?n+=o.amount*3.75:o.betPosition===5&&(n+=o.amount*2.4)}),this.gameContainer.listCoinBet.listCoinBet.length>0&&n){let o=this.gameContainer.listCoinBet.listCoinBet[0].playerID;Xt(this.gameContainer.container,this.gameContainer.playerContainer.listPlayerContainer[o].myPlayerContainer,n)}}),q(100),F(()=>{switch([0,2,4].indexOf(e)!==-1?this.gameContainer.listCoinBet.dealerToWinSpot(1):this.gameContainer.listCoinBet.dealerToWinSpot(2),e){case 0:{this.gameContainer.listCoinBet.dealerToWinSpot(7);break}case 1:{this.gameContainer.listCoinBet.dealerToWinSpot(6);break}case 2:{this.gameContainer.listCoinBet.dealerToWinSpot(5);break}case 3:{this.gameContainer.listCoinBet.dealerToWinSpot(4);break}case 4:{this.gameContainer.listCoinBet.dealerToWinSpot(3);break}}}),q(3e3),F(()=>{this.gameContainer.coinTossPlate.plateContainer.zIndex=h.plate.a}),X(n=>this.gameContainer.coinTossPlate.showPlate01()),X(n=>this.gameContainer.coinTossPlate.reset())).subscribe(n=>{i=!1})})},500)}))})}destroy(){return B(this,null,function*(){Et.stopAll(),this.screenSubscription?.unsubscribe(),this.gameContainer?.destroy(),this.game.destroy(!0),this.gameContainer=null})}};t.\u0275fac=function(e){return new(e||t)(Z(Zt),Z(j))},t.\u0275prov=st({token:t,factory:t.\u0275fac,providedIn:"root"});let a=t;return a})();var hi=["gameContainer"],Yt=(()=>{let t=class t{constructor(i,e,n){this.coinTossService=i,this.renderer=e,this.zone=n}ngOnDestroy(){return B(this,null,function*(){yield this.coinTossService.destroy(),this.renderer.removeChild(this.gameContainer.nativeElement,this.coinTossService.game.view)})}ngOnInit(){return B(this,null,function*(){yield this.zone.runOutsideAngular(()=>B(this,null,function*(){yield this.coinTossService.init(),this.renderer.appendChild(this.gameContainer.nativeElement,this.coinTossService.game.view)}))})}};t.\u0275fac=function(e){return new(e||t)(at(_t),at(Mt),at(j))},t.\u0275cmp=ot({type:t,selectors:[["app-coin-toss-game"]],viewQuery:function(e,n){if(e&1&&Nt(hi,7),e&2){let o;Ft(o=Ot())&&(n.gameContainer=o.first)}},standalone:!0,features:[ht],decls:2,vars:0,consts:[[1,"game-container"],["gameContainer",""]],template:function(e,n){e&1&&rt(0,"div",0,1)},styles:[".game-container[_ngcontent-%COMP%]{width:100vw;height:100vh;overflow:hidden;position:relative;background-image:url(/assets/img/sb-background.jpg);background-repeat:no-repeat;background-size:cover;background-position:center center;text-align:center}"]});let a=t;return a})();var gn=(()=>{let t=class t{};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=ot({type:t,selectors:[["app-coin-toss"]],standalone:!0,features:[ht],decls:1,vars:0,template:function(e,n){e&1&&rt(0,"app-coin-toss-game")},dependencies:[Yt]});let a=t;return a})();export{gn as CoinTossComponent};
