import{e as v}from"./chunk-UR5FVGYB.js";import{i as g}from"./chunk-J46DCBZ2.js";import{a as E,b as p}from"./chunk-5F6L35OW.js";import{p as c}from"./chunk-H75Z5SQQ.js";import{C as n,K as u,N as a,ob as d,pa as i,t as m,v as h,w as l,z as f}from"./chunk-U56GQCYX.js";var y=class{constructor(){this.fb=i(c),this.notification=i(g),this.cdr=i(d),this.formErrors={},this._formErrorMsg={},this.formSuccess=!1,this.defaultValue={},this.validators={}}set validateForm(r){this._validateForm=r,this.formValidationSubAuto()}get validateForm(){return this._validateForm}set formErrorMsg(r){this._formErrorMsg!=r&&(this._formErrorMsg=r,this.cdr.detectChanges())}get formErrorMsg(){return this._formErrorMsg}ngOnDestroy(){}formValidationSubAuto(){this.formValidation$=n(this.validateForm.valueChanges,this.validateForm.statusChanges).pipe(a(300)).subscribe(()=>{Object.keys(this.validateForm.controls).forEach(r=>{let s=this.validateForm.get(r),t=s.errors;t!=null&&s.dirty&&(this.formErrors[r]=this.formErrorMsg[r]&&this.formErrorMsg[r][Object.keys(t)[0]]||"Data is not valid")})})}getFormError(r){let s=this.validateForm.get(r);return s?s.valueChanges.pipe(a(200),f(t=>{if((s.dirty||s.touched)&&s.errors)if(this.formErrorMsg[r]){let o=Object.keys(s.errors)[0];return this.formErrorMsg[r][o]||this.formErrors[r]||"D\u01B0\u0303 li\xEA\u0323u kh\xF4ng h\u01A1\u0323p l\xEA\u0323"}else return this.formErrors[r];else return!1})):h(!1)}formValid(){return this.validateForm.valid?!0:(this.markAsDirty(),!1)}markAsDirty(){Object.values(this.validateForm.controls).forEach(r=>{r.invalid&&(r.markAsDirty(),r.markAllAsTouched(),r.updateValueAndValidity({onlySelf:!0,emitEvent:!0}))})}markControlDirty(r){r.markAsDirty(),r.markAllAsTouched(),r.updateValueAndValidity({onlySelf:!0,emitEvent:!0})}removeBlankString(r){let s={};for(let t in r)r[t]!==""&&(s[t]=r[t]);return s}httpErrorOperator(r){return s=>s.pipe(u(t=>(t.status===400?this.setHttpError(t,r):t.status===500&&this.notification.httpError(t,!0),l(()=>t))))}setHttpError(r,s){if(r.status===400){let t=r.error.message;t&&Array.isArray(t)&&t.length?t.forEach(o=>{let e=this.validateForm.controls[o.property];!e&&s&&(e=this.validateForm.controls[s]),e&&this.setFormError(e,o.property,o.code,o.message)}):this.notification.unknownError()}}setFormError(r,s,t,o){this.formErrors[s]=o,this.addFormDefaultErr(s,t,o),r.markAsDirty(),r.markAsTouched(),r.updateValueAndValidity({onlySelf:!0,emitEvent:!0}),r.setErrors({[t]:!0},{emitEvent:!0})}addFormDefaultErr(r,s,t){this.formErrorMsg[r]||(this.formErrorMsg[r]={}),this.formErrorMsg[r][s]=t}};y=m([v()],y);var A=class{constructor(){this.modal=i(p),this.nzModalData=i(E)}destroyModal(r){this.modal.destroy(r)}};export{y as a,A as b};
