import{a as T,c as cr,d as hr}from"./chunk-34HDRTDZ.js";import{a as S,b as ur,c as D,d as N,e as V,f as A,h as I}from"./chunk-NOZVI4NI.js";import{b as lr}from"./chunk-RIIX7NJE.js";import{a as gr}from"./chunk-L4H7QSRB.js";import{a as w,b as y,c as b}from"./chunk-G5NIHDB3.js";import"./chunk-MFIXJEMA.js";import"./chunk-4GNI6I26.js";import"./chunk-V2MLD7BC.js";import{a as ar,b as mr,d as pr,e as fr}from"./chunk-25WKB7ZZ.js";import{Ia as dr,T as nr,a as or,d as E,e as tr,g as z,h as v,j as er,l as ir,n as C,o as M,p as sr,r as F}from"./chunk-6UFVOUYD.js";import{Db as Z,Gb as g,H,K as P,Ra as a,Sa as J,Ua as Q,Va as Y,Xa as h,a as l,ab as n,b as X,ea as L,eb as m,fa as $,fb as p,gb as d,ka as K,la as c,mc as rr,na as f,nb as O,q as j,s as R,t as x,va as W,w as U,z as q,zb as u}from"./chunk-JOMHHM4A.js";var _=e=>typeof e=="function",Er=e=>{e&&_(e.unsubscribe)&&e.unsubscribe()},wr=e=>{Array.isArray(e)&&e.forEach(Er)};function zr({blackList:e=[],arrayName:r="",event:s="ngOnDestroy"}={}){return function(o){let t=o.prototype[s];if(!_(t))throw new Error(`${o.name} is using @AutoUnsubscribe but does not implement ${s}`);o.prototype[s]=function(){if(_(t)&&t.apply(this,arguments),r){wr(this[r]);return}for(let i in this){if(e.includes(i))continue;let k=this[i];Er(k)}}}}var G=class{constructor(){this.fb=c(sr),this.notification=c(lr),this.cdr=c(Q),this.formErrors={},this._formErrorMsg={},this.formSuccess=!1,this.defaultValue={},this.validators={}}set validateForm(r){this._validateForm=r,this.formValidationSubAuto()}get validateForm(){return this._validateForm}set formErrorMsg(r){this._formErrorMsg!=r&&(this._formErrorMsg=r,this.cdr.detectChanges())}get formErrorMsg(){return this._formErrorMsg}ngOnDestroy(){}formValidationSubAuto(){this.formValidation$=q(this.validateForm.valueChanges,this.validateForm.statusChanges).pipe(P(300)).subscribe(()=>{Object.keys(this.validateForm.controls).forEach(r=>{let s=this.validateForm.get(r),o=s.errors;o!=null&&s.dirty&&(this.formErrors[r]=this.formErrorMsg[r]&&this.formErrorMsg[r][Object.keys(o)[0]]||"Data is not valid")})})}getFormError(r){let s=this.validateForm.get(r);return s?s.valueChanges.pipe(P(200),U(o=>{if((s.dirty||s.touched)&&s.errors)if(this.formErrorMsg[r]){let t=Object.keys(s.errors)[0];return this.formErrorMsg[r][t]||this.formErrors[r]||"D\u01B0\u0303 li\xEA\u0323u kh\xF4ng h\u01A1\u0323p l\xEA\u0323"}else return this.formErrors[r];else return!1})):R(!1)}formValid(){return this.validateForm.valid?!0:(this.markAsDirty(),!1)}markAsDirty(){Object.values(this.validateForm.controls).forEach(r=>{r.invalid&&(r.markAsDirty(),r.markAllAsTouched(),r.updateValueAndValidity({onlySelf:!0,emitEvent:!0}))})}markControlDirty(r){r.markAsDirty(),r.markAllAsTouched(),r.updateValueAndValidity({onlySelf:!0,emitEvent:!0})}removeBlankString(r){let s={};for(let o in r)r[o]!==""&&(s[o]=r[o]);return s}httpErrorOperator(r){return s=>s.pipe(H(o=>(o.status===400?this.setHttpError(o,r):o.status===500&&this.notification.httpError(o,!0),x(()=>o))))}setHttpError(r,s){if(r.status===400){let o=r.error.message;o&&Array.isArray(o)&&o.length?o.forEach(t=>{let i=this.validateForm.controls[t.property];!i&&s&&(i=this.validateForm.controls[s]),i&&this.setFormError(i,t.property,t.code,t.message)}):this.notification.unknownError()}}setFormError(r,s,o,t){this.formErrors[s]=t,this.addFormDefaultErr(s,o,t),r.markAsDirty(),r.markAsTouched(),r.updateValueAndValidity({onlySelf:!0,emitEvent:!0}),r.setErrors({[o]:!0},{emitEvent:!0})}addFormDefaultErr(r,s,o){this.formErrorMsg[r]||(this.formErrorMsg[r]={}),this.formErrorMsg[r][s]=o}};G=j([zr()],G);var vr=(()=>{let r=class r{set formErrorMsg(o){this._formErrorMsg!=o&&o&&(this._formErrorMsg=o,this.formErrorMsgChange.next(o))}addControl(o,t){let i=this.formGroup.get(o);i?i.setValidators(t):this.formGroup.addControl(o,new er(this.defaultValue[o]||"",{validators:t}))}get formErrorMsg(){return this._formErrorMsg}emitNewErrorMsg(o){this.formErrorMsg=X(l({},this.formErrorMsg),{[o]:l(l({},this.formErrorMsg[o]||{}),this.validatorError[o])})}setValidators(o,t){return o?(Array.isArray(o)?o.push(...t):o=[o,...t],o):t}writeValue(o){}registerOnChange(o){}registerOnTouched(o){}constructor(){this.formErrors={},this.defaultValue={},this.validators={},this._formErrorMsg={},this.validatorError={},this.formErrorMsgChange=new Y}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=f({type:r,selectors:[["ng-component"]],inputs:{formGroup:"formGroup",formErrors:"formErrors",defaultValue:"defaultValue",validators:"validators",formErrorMsg:"formErrorMsg"},outputs:{formErrorMsgChange:"formErrorMsgChange"},decls:0,vars:0,template:function(t,i){},encapsulation:2});let e=r;return e})();var Cr=(()=>{let r=class r extends vr{constructor(){super(...arguments),this.validatorError=hr}ngOnInit(){this.addControl("password",T.password),this.addControl("passwordConfirm",T.passwordConfirm),this.formGroup.addValidators(cr.validators),this.emitNewErrorMsg("password"),this.emitNewErrorMsg("passwordConfirm")}};r.\u0275fac=(()=>{let o;return function(i){return(o||(o=W(r)))(i||r)}})(),r.\u0275cmp=f({type:r,selectors:[["app-password-confirm"]],inputs:{formGroup:"formGroup",formErrors:"formErrors",errorMsgGroup:"errorMsgGroup",defaultValue:"defaultValue",validators:"validators",formErrorMsg:"formErrorMsg"},outputs:{formErrorMsgChange:"formErrorMsgChange"},standalone:!0,features:[Z([{provide:or,useExisting:L(()=>r),multi:!0}]),h,g],decls:11,vars:11,consts:[[3,"formGroup"],["nzFor","password","nzRequired","",3,"nzSm","nzXs"],[3,"nzSm","nzXs","nzErrorTip"],["nz-input","","type","password","id","password","formControlName","password"],["nzFor","passwordConfirm","nzRequired","",3,"nzSm","nzXs"],["nz-input","","type","password","formControlName","passwordConfirm","id","passwordConfirm"]],template:function(t,i){t&1&&(m(0,"div",0)(1,"nz-form-item")(2,"nz-form-label",1),u(3,"Password"),p(),m(4,"nz-form-control",2),d(5,"input",3),p()(),m(6,"nz-form-item")(7,"nz-form-label",4),u(8,"Confirm Password"),p(),m(9,"nz-form-control",2),d(10,"input",5),p()()()),t&2&&(n("formGroup",i.formGroup),a(2),n("nzSm",10)("nzXs",24),a(2),n("nzSm",14)("nzXs",24)("nzErrorTip",i.formErrors.password),a(3),n("nzSm",10)("nzXs",24),a(2),n("nzSm",14)("nzXs",24)("nzErrorTip",i.formErrors.passwordConfirm))},dependencies:[V,y,w,S,N,D,I,A,b,F,E,z,v,C,M]});let e=r;return e})();var Mr=(()=>{let r=class r{constructor(o){this.http=o}changePassword(o){return this.http.post(dr.apiUrl+"change-password",o)}};r.\u0275fac=function(t){return new(t||r)(K(rr))},r.\u0275prov=$({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();var Eo=(()=>{let r=class r extends gr(G){constructor(o){super(),this.changePassword=o,this._formErrorMsg={oldPassword:{required:"M\xE2\u0323t kh\xE2\u0309u hi\xEA\u0323n ta\u0323i kh\xF4ng \u0111\u01B0\u01A1\u0323c \u0111\xEA\u0309 tr\xF4\u0301ng"}}}ngOnInit(){this.validateForm=this.fb.group({oldPassword:["",[tr.required]]})}submitForm(){this.formValid()&&this.changePassword.changePassword(this.validateForm.value).pipe(this.httpErrorOperator("oldPassword")).subscribe(o=>{o.status?this.notification.success("Tha\u0300nh c\xF4ng","\u0110\xF4\u0309i m\xE2\u0323t kh\xE2\u0309u tha\u0300nh c\xF4ng, vui lo\u0300ng \u0111\u0103ng nh\xE2\u0323p la\u0323i",1e4):this.notification.unknownError()})}};r.\u0275fac=function(t){return new(t||r)(J(Mr))},r.\u0275cmp=f({type:r,selectors:[["app-change-password"]],standalone:!0,features:[h,g],decls:11,vars:13,consts:[["nz-form","",3,"formGroup","ngSubmit"],["nzFor","oldPassword","nzRequired","",3,"nzSm","nzXs"],[3,"nzSm","nzXs","nzErrorTip"],["nz-input","","type","password","id","oldPassword","formControlName","oldPassword"],[3,"validators","formErrorMsg","formGroup","formErrors","formErrorMsgChange"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary",3,"disabled"]],template:function(t,i){t&1&&(m(0,"form",0),O("ngSubmit",function(){return i.submitForm()}),m(1,"nz-form-item")(2,"nz-form-label",1),u(3,"M\xE2\u0323t kh\xE2\u0309u hi\xEA\u0323n ta\u0323i"),p(),m(4,"nz-form-control",2),d(5,"input",3),p()(),m(6,"app-password-confirm",4),O("formErrorMsgChange",function(Fr){return i.formErrorMsg=Fr}),p(),m(7,"nz-form-item",5)(8,"nz-form-control",6)(9,"button",7),u(10,"\u0110\xF4\u0309i m\xE2\u0323t kh\xE2\u0309u ta\u0300i khoa\u0309n"),p()()()()),t&2&&(n("formGroup",i.validateForm),a(2),n("nzSm",10)("nzXs",24),a(2),n("nzSm",14)("nzXs",24)("nzErrorTip",i.formErrors.oldPassword),a(2),n("validators",i.validators)("formErrorMsg",i.formErrorMsg)("formGroup",i.validateForm)("formErrors",i.formErrors),a(2),n("nzSpan",12)("nzOffset",8),a(),n("disabled",!i.validateForm.valid))},dependencies:[b,y,w,V,ur,S,N,D,I,A,F,ir,E,z,v,C,M,fr,pr,ar,mr,nr,Cr],encapsulation:2});let e=r;return e})();export{Eo as ChangePasswordComponent};
